(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a4096"],{"0572":function(e,t,r){"use strict";r.r(t);r("b0c0"),r("a4d3"),r("e01a");var n=r("7a23"),o={class:"hstack mb-3"},a=Object(n["createElementVNode"])("i",{class:"bx bx-plus font-size-16 align-middle me-2"},null,-1),c=Object(n["createTextVNode"])(" Ajouter un nouveau "),l={class:"row"},s={class:"col-lg-12"},i={class:"card"},d={class:"card-body"},u=Object(n["createElementVNode"])("h4",{class:"card-title"},"Listes des partenaires",-1),m=Object(n["createElementVNode"])("p",{class:"card-title-desc"},[Object(n["createTextVNode"])(" Le tableau ci-dessous présente la listes des "),Object(n["createElementVNode"])("code",null,"partenaires"),Object(n["createTextVNode"])(". ")],-1),p={class:"table-responsive"},b={class:"table align-middle mb-0"},O=Object(n["createElementVNode"])("thead",null,[Object(n["createElementVNode"])("tr",null,[Object(n["createElementVNode"])("th",null,"#"),Object(n["createElementVNode"])("th",null,"Nom du partenaire"),Object(n["createElementVNode"])("th",null,"Email"),Object(n["createElementVNode"])("th",null,"Responsable"),Object(n["createElementVNode"])("th",null,"Action")])],-1),j={scope:"row"},h={class:"hstack"},f=Object(n["createElementVNode"])("i",{class:"bx bx-edit font-size-16 align-middle mx-1"},null,-1),E=Object(n["createElementVNode"])("i",{class:"bx bx-trash font-size-16 align-middle mx-1"},null,-1),V={class:"row"},g={class:"col-md-6 mb-3"},N=Object(n["createElementVNode"])("option",{value:""},"Selectionnez le responsable",-1),v=["value"],k={key:0,class:"text-danger mt-2"},y={class:"col-md-6 mb-3"},x={key:0,class:"text-danger mt-2"},B=Object(n["createElementVNode"])("div",{class:"col-md-6 mb-3"},[Object(n["createElementVNode"])("label",{for:""},"Logo du partenaire"),Object(n["createElementVNode"])("input",{type:"file",required:"",id:"file",class:"form-control"})],-1),D={class:"col-md-6 mb-3"},C=Object(n["createElementVNode"])("label",{for:""},"Email du partenaire",-1),w={key:0,class:"text-danger mt-2"},_={class:"col-md-6 mb-3"},S={key:0,class:"text-danger mt-2"},T={class:"col-md-6 mb-3"},L={key:0,class:"text-danger mt-2"},U={key:0,class:"text-danger mt-2"},q={key:0,class:"mt-3"},M=Object(n["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),A=[M],P={key:1,class:"mt-3 text-center"},I=Object(n["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),z=[I],F={class:"row"},H={class:"col-md-6 mb-3"},J=Object(n["createElementVNode"])("option",{value:""},"Selectionnez le responsable",-1),R=["value"],G={key:0,class:"text-danger mt-2"},K={class:"col-md-6 mb-3"},Q={key:0,class:"text-danger mt-2"},W=Object(n["createElementVNode"])("div",{class:"col-md-6 mb-3"},[Object(n["createElementVNode"])("label",{for:""},"Logo du partenaire"),Object(n["createElementVNode"])("input",{type:"file",id:"file1",class:"form-control"})],-1),X={class:"col-md-6 mb-3"},Y=Object(n["createElementVNode"])("label",{for:""},"Email du partenaire",-1),Z={key:0,class:"text-danger mt-2"},$={class:"col-md-6 mb-3"},ee={key:0,class:"text-danger mt-2"},te={class:"col-md-6 mb-3"},re={key:0,class:"text-danger mt-2"},ne={key:0,class:"text-danger mt-2"},oe={key:0,class:"mt-3"},ae=Object(n["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),ce=[ae],le={key:1,class:"mt-3 text-center"},se=Object(n["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),ie=[se],de={class:"mb-2"},ue=Object(n["createTextVNode"])(" Voulez-vous vraiment supprimer le partenaire "),me=Object(n["createElementVNode"])("p",{class:"text-danger"},"Attention ! Supprimer un partenaire implique la suppression de ces projets.",-1),pe={key:0,class:"hstack mt-2"},be={key:1,class:"text-center"},Oe=Object(n["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(n["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),je=[Oe];function he(e,t,r,M,I,ae){var se=Object(n["resolveComponent"])("PageHeader"),Oe=Object(n["resolveComponent"])("b-button"),he=Object(n["resolveComponent"])("router-link"),fe=Object(n["resolveComponent"])("b-modal"),Ee=Object(n["resolveComponent"])("Layout");return Object(n["openBlock"])(),Object(n["createBlock"])(Ee,null,{default:Object(n["withCtx"])((function(){return[Object(n["createVNode"])(se,{title:I.title,items:I.items},null,8,["title","items"]),Object(n["createElementVNode"])("div",o,[Object(n["createVNode"])(Oe,{variant:"primary",onClick:t[0]||(t[0]=function(e){return M.doesAddOpen=!0}),class:"ms-auto"},{default:Object(n["withCtx"])((function(){return[a,c]})),_:1})]),Object(n["createElementVNode"])("div",l,[Object(n["createElementVNode"])("div",s,[Object(n["createElementVNode"])("div",i,[Object(n["createElementVNode"])("div",d,[u,m,Object(n["createElementVNode"])("div",p,[Object(n["createElementVNode"])("table",b,[O,Object(n["createElementVNode"])("tbody",null,[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(I.patners,(function(e,t){return Object(n["openBlock"])(),Object(n["createElementBlock"])("tr",{key:e.id},[Object(n["createElementVNode"])("th",j,Object(n["toDisplayString"])(t+1),1),Object(n["createElementVNode"])("td",null,[Object(n["createVNode"])(he,{to:"/cdn/patners/"+e.id},{default:Object(n["withCtx"])((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.name),1)]})),_:2},1032,["to"])]),Object(n["createElementVNode"])("td",null,Object(n["toDisplayString"])(e.email),1),Object(n["createElementVNode"])("td",null,[Object(n["createVNode"])(he,{to:"/cdn/users/"+e.user.id},{default:Object(n["withCtx"])((function(){return[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.user.lastname+" "+e.user.firstname),1)]})),_:2},1032,["to"])]),Object(n["createElementVNode"])("td",h,[Object(n["createVNode"])(Oe,{class:"btn-sm",onClick:function(t){return ae.initItem(e)},variant:"success"},{default:Object(n["withCtx"])((function(){return[f]})),_:2},1032,["onClick"]),Object(n["createVNode"])(Oe,{variant:"danger",onClick:function(t){return ae.initItem(e,"delete")},class:"ms-2 btn-sm"},{default:Object(n["withCtx"])((function(){return[E]})),_:2},1032,["onClick"])])])})),128))])])])])])])]),Object(n["createVNode"])(fe,{modelValue:M.doesAddOpen,"onUpdate:modelValue":t[8]||(t[8]=function(e){return M.doesAddOpen=e}),id:"modal-center",size:"lg",centered:"",title:"Ajouter un partenaire","title-class":"font-18","hide-footer":""},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("form",{onSubmit:t[7]||(t[7]=Object(n["withModifiers"])((function(e){return ae.addItem()}),["prevent"]))},[Object(n["createElementVNode"])("div",V,[Object(n["createElementVNode"])("div",g,[Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{required:"","onUpdate:modelValue":t[1]||(t[1]=function(e){return I.user_id=e}),class:"form-control"},[N,(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(I.users,(function(e){return Object(n["openBlock"])(),Object(n["createElementBlock"])("option",{key:e.id,value:e.id},Object(n["toDisplayString"])(e.lastname+" "+e.firstname),9,v)})),128))],512),[[n["vModelSelect"],I.user_id]]),I.errors.user_id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",k,Object(n["toDisplayString"])(I.errors.user_id),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",y,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",required:"",placeholder:"Nom du partenaire","onUpdate:modelValue":t[2]||(t[2]=function(e){return I.name=e}),class:"form-control"},null,512),[[n["vModelText"],I.name]]),I.errors.name?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",x,Object(n["toDisplayString"])(I.errors.name),1)):Object(n["createCommentVNode"])("",!0)]),B,Object(n["createElementVNode"])("div",D,[C,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"email",required:"",placeholder:"Email du partenaire","onUpdate:modelValue":t[3]||(t[3]=function(e){return I.email=e}),class:"form-control"},null,512),[[n["vModelText"],I.email]]),I.errors.email?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",w,Object(n["toDisplayString"])(I.errors.email),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",_,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"tel",required:"",placeholder:"Téléphone du partenaire","onUpdate:modelValue":t[4]||(t[4]=function(e){return I.phone=e}),class:"form-control"},null,512),[[n["vModelText"],I.phone]]),I.errors.phone?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",S,Object(n["toDisplayString"])(I.errors.phone),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",T,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",placeholder:"Adresse du partenaire","onUpdate:modelValue":t[5]||(t[5]=function(e){return I.address=e}),class:"form-control"},null,512),[[n["vModelText"],I.address]]),I.errors.address?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",L,Object(n["toDisplayString"])(I.errors.address),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",null,[Object(n["withDirectives"])(Object(n["createElementVNode"])("textarea",{"onUpdate:modelValue":t[6]||(t[6]=function(e){return I.description=e}),placeholder:"Description du partenaire",class:"form-control",rows:"4"},null,512),[[n["vModelText"],I.description]]),I.errors.description?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",U,Object(n["toDisplayString"])(I.errors.description),1)):Object(n["createCommentVNode"])("",!0)])]),I.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",P,z)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",q,A))],32)]})),_:1},8,["modelValue"]),Object(n["createVNode"])(fe,{modelValue:M.doesEditOpen,"onUpdate:modelValue":t[16]||(t[16]=function(e){return M.doesEditOpen=e}),id:"modal-center",centered:"",size:"lg",title:"Modifier le partenaire","title-class":"font-18","hide-footer":""},{default:Object(n["withCtx"])((function(){return[Object(n["createElementVNode"])("form",{onSubmit:t[15]||(t[15]=Object(n["withModifiers"])((function(e){return ae.editItem()}),["prevent"]))},[Object(n["createElementVNode"])("div",F,[Object(n["createElementVNode"])("div",H,[Object(n["withDirectives"])(Object(n["createElementVNode"])("select",{required:"","onUpdate:modelValue":t[9]||(t[9]=function(e){return I.user_id=e}),class:"form-control"},[J,(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(I.users,(function(e){return Object(n["openBlock"])(),Object(n["createElementBlock"])("option",{key:e.id,value:e.id},Object(n["toDisplayString"])(e.lastname+" "+e.firstname),9,R)})),128))],512),[[n["vModelSelect"],I.user_id]]),I.errors.user_id?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",G,Object(n["toDisplayString"])(I.errors.user_id),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",K,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",required:"",placeholder:"Nom du partenaire","onUpdate:modelValue":t[10]||(t[10]=function(e){return I.name=e}),class:"form-control"},null,512),[[n["vModelText"],I.name]]),I.errors.name?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Q,Object(n["toDisplayString"])(I.errors.name),1)):Object(n["createCommentVNode"])("",!0)]),W,Object(n["createElementVNode"])("div",X,[Y,Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"email",required:"",placeholder:"Email du partenaire","onUpdate:modelValue":t[11]||(t[11]=function(e){return I.email=e}),class:"form-control"},null,512),[[n["vModelText"],I.email]]),I.errors.email?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",Z,Object(n["toDisplayString"])(I.errors.email),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",$,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"tel",required:"",placeholder:"Téléphone du partenaire","onUpdate:modelValue":t[12]||(t[12]=function(e){return I.phone=e}),class:"form-control"},null,512),[[n["vModelText"],I.phone]]),I.errors.phone?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",ee,Object(n["toDisplayString"])(I.errors.phone),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",te,[Object(n["withDirectives"])(Object(n["createElementVNode"])("input",{type:"text",placeholder:"Adresse du partenaire","onUpdate:modelValue":t[13]||(t[13]=function(e){return I.address=e}),class:"form-control"},null,512),[[n["vModelText"],I.address]]),I.errors.address?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",re,Object(n["toDisplayString"])(I.errors.address),1)):Object(n["createCommentVNode"])("",!0)]),Object(n["createElementVNode"])("div",null,[Object(n["withDirectives"])(Object(n["createElementVNode"])("textarea",{"onUpdate:modelValue":t[14]||(t[14]=function(e){return I.description=e}),required:"",placeholder:"Description du partenaire",class:"form-control",rows:"4"},null,512),[[n["vModelText"],I.description]]),I.errors.description?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",ne,Object(n["toDisplayString"])(I.errors.description),1)):Object(n["createCommentVNode"])("",!0)])]),I.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",le,ie)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",oe,ce))],32)]})),_:1},8,["modelValue"]),Object(n["createVNode"])(fe,{modelValue:M.doesDeleteOpen,"onUpdate:modelValue":t[19]||(t[19]=function(e){return M.doesDeleteOpen=e}),id:"modal-center",title:"Supprimer le partenaire","title-class":"font-18","hide-footer":""},{default:Object(n["withCtx"])((function(){var e;return[Object(n["createElementVNode"])("p",de,[ue,Object(n["createElementVNode"])("b",null,Object(n["toDisplayString"])(null===(e=I.sector)||void 0===e?void 0:e.name),1)]),me,I.loading?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",be,je)):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",pe,[Object(n["createElementVNode"])("button",{class:"btn btn-dark ms-auto",onClick:t[17]||(t[17]=function(e){return M.doesDeleteOpen=!1})},"Annuler"),Object(n["createElementVNode"])("button",{class:"ms-3 btn btn-danger",onClick:t[18]||(t[18]=function(e){return ae.deleteIt()})},"Supprimer")]))]})),_:1},8,["modelValue"])]})),_:1})}r("d3b7"),r("d81d"),r("4de4");var fe=r("3d20"),Ee=r.n(fe),Ve=r("444f"),ge=r("c2a4"),Ne=r("2579"),ve=r("e01f"),ke={setup:function(){var e=Object(n["ref"])(!1),t=Object(n["ref"])(!1),r=Object(n["ref"])(!1);return{doesAddOpen:e,doesEditOpen:t,doesDeleteOpen:r}},page:{title:"Partenaires",meta:[{name:"description",content:ge.description}]},components:{Layout:Ve["a"],PageHeader:Ne["a"]},data:function(){return{title:"Partenaires",items:[{text:"Menu",href:"/"},{text:"Partenaires",active:!0}],errors:[],categories:[],users:[],sector:{},patners:[],user_id:"",name:"",description:"",type:"PATNER",email:"",phone:"",address:"",loading:!1,status:201}},methods:{loadList:function(){var e=this;fetch(ve["a"].route("entities?type="+this.type),ve["a"].requestOptions()).then((function(e){return ve["a"].tokenChecker(e.status),e.json()})).then((function(t){console.log(t.data),e.patners=t.data}))},addItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("user_id",this.user_id),t.append("name",this.name),t.append("phone",this.phone),t.append("email",this.email),t.append("address",this.address),t.append("description",this.description),t.append("type",this.type),t.append("file",document.getElementById("file").files[0]),fetch(ve["a"].route("entities"),ve["a"].requestOptions("POST",t)).then((function(t){return ve["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,200==e.status?(e.initData(null),e.doesAddOpen=!1,e.patners.push(t.data),Ee.a.fire("Partenaire ajouter !","Le partenaire a été enregistrée avec succès.","success")):(console.log(ve["a"].getError(t.data,"user_id")),e.errors.category_id=ve["a"].getError(t.data,"category_id"),e.errors.user_id=ve["a"].getError(t.data,"user_id"),e.errors.name=ve["a"].getError(t.data,"name"),e.errors.phone=ve["a"].getError(t.data,"phone"),e.errors.email=ve["a"].getError(t.data,"email"),e.errors.address=ve["a"].getError(t.data,"address"),e.errors.description=ve["a"].getError(t.data,"description"))})).catch((function(t){console.log(t),e.loading=!1}))},editItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("_method","PUT"),t.append("user_id",this.user_id),t.append("name",this.name),t.append("phone",this.phone),t.append("email",this.email),t.append("address",this.address),t.append("description",this.description),t.append("type",this.type),document.getElementById("file1").files[0]&&t.append("file1",document.getElementById("file").files[0]),console.log(t.get("name"),"id",this.sector.id),fetch(ve["a"].route("entities/"+this.sector.id),ve["a"].requestOptions("POST",t)).then((function(t){return ve["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(e.status),console.log("last",e.sector),console.log("new",t.data),e.loading=!1,200==e.status?(e.doesEditOpen=!1,e.patners=e.patners.map((function(r){return r.id!==e.sector.id?r:t.data})),Ee.a.fire("Partenaire modifier !","La partenaire a été modifiée avec succès.","success")):(e.errors.category_id=ve["a"].getError(t.data,"category_id"),e.errors.user_id=ve["a"].getError(t.data,"user_id"),e.errors.name=ve["a"].getError(t.data,"name"),e.errors.phone=ve["a"].getError(t.data,"phone"),e.errors.email=ve["a"].getError(t.data,"email"),e.errors.address=ve["a"].getError(t.data,"address"),e.errors.description=ve["a"].getError(t.data,"description"))})).catch((function(t){console.log(t),e.loading=!1}))},deleteIt:function(){var e=this;this.loading=!0,fetch(ve["a"].route("entities/"+this.sector.id),ve["a"].requestOptions("DELETE")).then((function(t){return ve["a"].tokenChecker(t.status),e.status=t.status,t.text()})).then((function(t){console.log(e.status),console.log(t),console.log(e.sector.id),e.name="",e.loading=!1,e.doesDeleteOpen=!1,204==e.status?(e.patners=e.patners.filter((function(t){console.log(t),t.id,e.sector.id})),Ee.a.fire("Partenaire supprimer !","La partenaire a été supprimée avec succès.","success")):Ee.a.fire("Partenaire non supprimer ?","La suppression n'a pas marché, veuillez réessayez plus tard.","error"),e.sector=null}))},loadCategories:function(){var e=this;fetch(ve["a"].route("categories"),ve["a"].requestOptions()).then((function(e){return ve["a"].tokenChecker(e.status),e.json()})).then((function(t){e.categories=t.data}))},loadUsers:function(){var e=this;fetch(ve["a"].route("users"),ve["a"].requestOptions()).then((function(e){return ve["a"].tokenChecker(e.status),e.json()})).then((function(t){e.users=t.data}))},initItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit";this.sector=e,this.initData(e),"delete"==t?this.doesDeleteOpen=!0:this.doesEditOpen=!0},initData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.user_id=null!=e?e.user_id:"",this.name=null!=e?e.name:"",this.email=null!=e?e.email:"",this.phone=null!=e?e.phone:"",this.address=null!=e?e.address:"",this.description=null!=e?e.description:""}},mounted:function(){this.loadList(),this.loadCategories(),this.loadUsers()},watch:{doesAddOpen:function(){this.errors=[]},doesEditOpen:function(){this.errors=[],this.doesEditOpen||(this.sector=null,this.initData(null))},doesDeleteOpen:function(){this.doesDeleteOpen||(this.sector=null,this.initData(null))}}},ye=r("6b0d"),xe=r.n(ye);const Be=xe()(ke,[["render",he]]);t["default"]=Be}}]);
//# sourceMappingURL=chunk-2d0a4096.605650b5.js.map