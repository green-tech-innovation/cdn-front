(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d229aff"],{df07:function(e,t,n){"use strict";n.r(t);n("b0c0"),n("a4d3"),n("e01a");var c=n("7a23"),a={class:"hstack mb-3"},i={class:"ms-auto"},o=Object(c["createElementVNode"])("i",{class:"bx bx-send font-size-16 align-middle me-2"},null,-1),r=Object(c["createTextVNode"])(" Envoyer un rappel "),l={key:1,class:"text-center"},s=Object(c["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(c["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),d=[s],u=Object(c["createElementVNode"])("i",{class:"bx bx-plus font-size-16 align-middle me-2"},null,-1),p=Object(c["createTextVNode"])(" Ajouter un participant "),b={key:0,class:"row"},m={class:"col-lg-12"},O={class:"card"},j={class:"card-body"},f={class:"card-title"},v={class:"my-2"},h=Object(c["createTextVNode"])(" Date de Fin : "),k={class:"text-danger"},E=Object(c["createTextVNode"])(" Lieu ou Lien : "),V={class:"card-title-desc",style:{"text-align":"justify"}},N=Object(c["createElementVNode"])("b",{class:"text-black"},"Un peu de detail",-1),g=Object(c["createTextVNode"])(),y=Object(c["createElementVNode"])("br",null,null,-1),x={class:"bg-light p-3 pt-3"},B=Object(c["createElementVNode"])("h6",{class:"font-20 text-danger"},"♣ Listes des participants",-1),C={class:"table-responsive"},D={class:"table align-middle mb-0"},w=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"#"),Object(c["createElementVNode"])("th",null,"Nom du participant"),Object(c["createElementVNode"])("th",null,"Action")])],-1),_={scope:"row"},S={class:"hstack"},L=Object(c["createElementVNode"])("i",{class:"bx bx-trash font-size-16 align-middle mx-1"},null,-1),A=Object(c["createElementVNode"])("label",{for:""},"Selectionnez l'entité",-1),T=["value"],I={key:0,class:"text-danger mt-2"},R={key:0,class:"mt-3"},z=Object(c["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),P=[z],q={key:1,class:"mt-3 text-center"},U=Object(c["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(c["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),F=[U],J=Object(c["createElementVNode"])("p",{class:"mb-2"}," Voulez-vous vraiment supprimer le participant ? ",-1),M={key:0,class:"hstack mt-2"},H={key:1,class:"text-center"},$=Object(c["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(c["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),G=[$];function K(e,t,n,s,z,U){var $=Object(c["resolveComponent"])("PageHeader"),K=Object(c["resolveComponent"])("b-button"),Q=Object(c["resolveComponent"])("router-link"),W=Object(c["resolveComponent"])("b-modal"),X=Object(c["resolveComponent"])("Layout");return Object(c["openBlock"])(),Object(c["createBlock"])(X,null,{default:Object(c["withCtx"])((function(){var e;return[Object(c["createVNode"])($,{title:z.title,items:z.items},null,8,["title","items"]),Object(c["createElementVNode"])("div",a,[Object(c["createElementVNode"])("div",i,[0!=(null===(e=z.event.participants)||void 0===e?void 0:e.length)?(Object(c["openBlock"])(),Object(c["createElementBlock"])(c["Fragment"],{key:0},[z.loadingRapport?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",l,d)):(Object(c["openBlock"])(),Object(c["createBlock"])(K,{key:0,variant:"success",onClick:t[0]||(t[0]=function(e){return U.sendReminder()}),class:"ms-auto"},{default:Object(c["withCtx"])((function(){return[o,r]})),_:1}))],64)):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(K,{variant:"primary",onClick:t[1]||(t[1]=function(e){return s.doesAddOpen=!0}),class:"ms-3"},{default:Object(c["withCtx"])((function(){return[u,p]})),_:1})]),z.event.id?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",b,[Object(c["createElementVNode"])("div",m,[Object(c["createElementVNode"])("div",O,[Object(c["createElementVNode"])("div",j,[Object(c["createElementVNode"])("h4",f,Object(c["toDisplayString"])(z.event.name),1),Object(c["createElementVNode"])("p",v,[h,Object(c["createElementVNode"])("b",k,Object(c["toDisplayString"])(z.event.date),1)]),Object(c["createElementVNode"])("p",null,[E,Object(c["createElementVNode"])("b",null,Object(c["toDisplayString"])(z.event.place_link),1)]),Object(c["createElementVNode"])("p",V,[N,g,y,Object(c["createTextVNode"])(" "+Object(c["toDisplayString"])(z.event.description),1)]),Object(c["createElementVNode"])("div",x,[B,Object(c["createElementVNode"])("div",C,[Object(c["createElementVNode"])("table",D,[w,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(z.event.participants,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("th",_,Object(c["toDisplayString"])(t+1),1),Object(c["createElementVNode"])("td",null,["PATNER"==e.entity.type?(Object(c["openBlock"])(),Object(c["createBlock"])(Q,{key:0,to:"/cdn/patners/"+e.entity.id},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.entity.name),1)]})),_:2},1032,["to"])):(Object(c["openBlock"])(),Object(c["createBlock"])(Q,{key:1,to:"/cdn/sectors/"+e.entity.id},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.entity.name),1)]})),_:2},1032,["to"]))]),Object(c["createElementVNode"])("td",S,[Object(c["createVNode"])(K,{variant:"danger",onClick:function(t){return U.initItem(e,"delete")},class:"ms-2 btn-sm"},{default:Object(c["withCtx"])((function(){return[L]})),_:2},1032,["onClick"])])])})),128))])])])])])])])])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(W,{modelValue:s.doesAddOpen,"onUpdate:modelValue":t[4]||(t[4]=function(e){return s.doesAddOpen=e}),id:"modal-center",centered:"",title:"Ajouter une participant","title-class":"font-18","hide-footer":""},{default:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(c["withModifiers"])((function(e){return U.addItem()}),["prevent"]))},[Object(c["createElementVNode"])("div",null,[A,Object(c["withDirectives"])(Object(c["createElementVNode"])("select",{required:"",multiple:"","onUpdate:modelValue":t[2]||(t[2]=function(e){return z.entity_id=e}),class:"form-control"},[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(z.entities,(function(e){return Object(c["openBlock"])(),Object(c["createElementBlock"])("option",{key:e.id,value:e.id},Object(c["toDisplayString"])(e.name),9,T)})),128))],512),[[c["vModelSelect"],z.entity_id]]),z.errors.entity_id?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",I,Object(c["toDisplayString"])(z.errors.entity_id),1)):Object(c["createCommentVNode"])("",!0)]),z.loading?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",q,F)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",R,P))],32)]})),_:1},8,["modelValue"]),Object(c["createVNode"])(W,{modelValue:s.doesDeleteOpen,"onUpdate:modelValue":t[7]||(t[7]=function(e){return s.doesDeleteOpen=e}),id:"modal-center",title:"Supprimer la participant","title-class":"font-18","hide-footer":""},{default:Object(c["withCtx"])((function(){return[J,z.loading?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",H,G)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",M,[Object(c["createElementVNode"])("button",{class:"btn btn-dark ms-auto",onClick:t[5]||(t[5]=function(e){return s.doesDeleteOpen=!1})},"Annuler"),Object(c["createElementVNode"])("button",{class:"ms-3 btn btn-danger",onClick:t[6]||(t[6]=function(e){return U.deleteIt()})},"Supprimer")]))]})),_:1},8,["modelValue"])]})),_:1})}n("d3b7"),n("e9c4"),n("4de4"),n("d81d");var Q=n("3d20"),W=n.n(Q),X=n("444f"),Y=n("c2a4"),Z=n("2579"),ee=n("e01f"),te={setup:function(){var e=Object(c["ref"])(!1),t=Object(c["ref"])(!1),n=Object(c["ref"])(!1);return{doesAddOpen:e,doesEditOpen:t,doesDeleteOpen:n}},page:{title:"Evènement",meta:[{name:"description",content:Y.description}]},components:{Layout:X["a"],PageHeader:Z["a"]},data:function(){return{title:"Evènement",items:[{text:"Menu",href:"/"},{text:"Evènement",active:!0},{text:"Un évènement",active:!0}],id:"",errors:[],event:{},entities:[],entity_id:"",participant:{},loading:!1,loadingRapport:!1,status:201}},methods:{getItem:function(){var e=this;fetch(ee["a"].route("events/"+this.id),ee["a"].requestOptions()).then((function(e){return ee["a"].tokenChecker(e.status),e.json()})).then((function(t){console.log("event",t.data.participants),e.event=t.data}))},loadEntities:function(){var e=this;fetch(ee["a"].route("entities"),ee["a"].requestOptions()).then((function(e){return ee["a"].tokenChecker(e.status),e.json()})).then((function(t){e.entities=t.data}))},sendReminder:function(){var e=this;this.loadingRapport=!0,fetch(ee["a"].route("events/"+this.id+"/send-reminder"),ee["a"].requestOptions()).then((function(e){return ee["a"].tokenChecker(e.status),e.json()})).then((function(t){e.loadingRapport=!1,W.a.fire("Rappel envoyé !","Un message de rappel a été déjà envoyé  à tous les participants.","success"),console.log(t)}))},addItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("event_id",this.id),t.append("entity_id",JSON.stringify(this.entity_id)),fetch(ee["a"].route("participants"),ee["a"].requestOptions("POST",t)).then((function(t){return ee["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(t),e.loading=!1,200==e.status?(e.entity_id="",e.doesAddOpen=!1,e.event.participants=t.data,W.a.fire("Participant ajouter !","Le(les) participants a (ont) été enregistré(s) avec succès.","success")):e.errors.entity_id=ee["a"].getError(t.data,"entity_id")})).catch((function(t){console.log(t),e.loading=!1}))},deleteIt:function(){var e=this;this.loading=!0,fetch(ee["a"].route("participants/"+this.participant.id),ee["a"].requestOptions("DELETE")).then((function(t){return ee["a"].tokenChecker(t.status),e.status=t.status,t.text()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,e.doesDeleteOpen=!1,204==e.status?(e.event.participants=e.event.participants.filter((function(t){return t.id!==e.participant.id})),W.a.fire("Participant supprimer !","Le participant a été supprimé avec succès.","success")):W.a.fire("Participant non supprimer ?","La suppression n'a pas marché, veuillez réessayez plus tard.","error")}))},initItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit";this.participant=e,"delete"==t?this.doesDeleteOpen=!0:this.doesEditOpen=!0}},mounted:function(){this.id=this.$route.params.id,this.getItem(),this.loadEntities()},watch:{doesAddOpen:function(){var e=this;this.errors=[];var t=this.event.participants.map((function(e){return e.entity.id}));console.log(t);for(var n=function(n){e.entities=e.entities.filter((function(e){return e.id!==t[n]}))},c=0;c<t.length;c++)n(c)},doesDeleteOpen:function(){this.doesDeleteOpen||(this.participant=null)}}},ne=n("6b0d"),ce=n.n(ne);const ae=ce()(te,[["render",K]]);t["default"]=ae}}]);
//# sourceMappingURL=chunk-2d229aff.3bf5593a.js.map