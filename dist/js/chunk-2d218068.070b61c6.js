(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d218068"],{c8da:function(e,t,n){"use strict";n.r(t);n("b0c0"),n("a4d3"),n("e01a");var c=n("7a23"),o={key:0,class:"hstack mb-3"},s={class:"ms-auto"},r={key:0},a=Object(c["createElementVNode"])("i",{class:"bx bx-send font-size-16 align-middle me-2"},null,-1),l=Object(c["createTextVNode"])(" Publier le sondage "),i={key:1,class:"text-center"},d=Object(c["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(c["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),u=[d],b=Object(c["createElementVNode"])("i",{class:"bx bx-plus font-size-16 align-middle me-2"},null,-1),m=Object(c["createTextVNode"])(" Ajouter un nouveau "),O={key:1,class:"row"},j={class:"col-lg-12"},p={class:"card"},v={class:"card-body"},h={class:"card-title"},f={class:"text-danger mb-2"},y={class:"card-title-desc"},g={class:"bg-light p-3 pt-3"},V=Object(c["createElementVNode"])("h6",{class:"font-20 text-danger"},"♣ Listes des options",-1),E={class:"table-responsive"},N={class:"table align-middle mb-0"},k=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"#"),Object(c["createElementVNode"])("th",null,"Sondage"),Object(c["createElementVNode"])("th",{class:"text-center"},"Nombre de vote"),Object(c["createElementVNode"])("th",null,"Date d'ajout")])],-1),x={scope:"row"},B={class:"text-center"},C=Object(c["createElementVNode"])("label",{for:""},"Option",-1),S={key:0,class:"text-danger mt-2"},w={key:0,class:"mt-3"},D=Object(c["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),_=[D],A={key:1,class:"mt-3 text-center"},P=Object(c["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(c["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),L=[P];function I(e,t,n,d,D,P){var I=Object(c["resolveComponent"])("PageHeader"),T=Object(c["resolveComponent"])("b-button"),q=Object(c["resolveComponent"])("router-link"),U=Object(c["resolveComponent"])("b-modal"),F=Object(c["resolveComponent"])("Layout");return Object(c["openBlock"])(),Object(c["createBlock"])(F,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(I,{title:D.title,items:D.items},null,8,["title","items"]),0==D.survey.is_published?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",o,[Object(c["createElementVNode"])("div",s,[0!=D.survey.survey_items.length?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",r,[D.loadingPublish?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",i,u)):(Object(c["openBlock"])(),Object(c["createBlock"])(T,{key:0,variant:"success",onClick:t[0]||(t[0]=function(e){return P.publishSurvey()}),class:"ms-auto"},{default:Object(c["withCtx"])((function(){return[a,l]})),_:1}))])):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(T,{variant:"primary",class:"ms-3",onClick:t[1]||(t[1]=function(e){return d.doesAddOpen=!0})},{default:Object(c["withCtx"])((function(){return[b,m]})),_:1})])):Object(c["createCommentVNode"])("",!0),D.survey!={}?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",O,[Object(c["createElementVNode"])("div",j,[Object(c["createElementVNode"])("div",p,[Object(c["createElementVNode"])("div",v,[Object(c["createElementVNode"])("h4",h,Object(c["toDisplayString"])(D.survey.name),1),Object(c["createElementVNode"])("p",f," Date de Fin : "+Object(c["toDisplayString"])(D.survey.date),1),Object(c["createElementVNode"])("p",y,Object(c["toDisplayString"])(D.survey.description),1),Object(c["createElementVNode"])("div",g,[V,Object(c["createElementVNode"])("div",E,[Object(c["createElementVNode"])("table",N,[k,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(D.survey.survey_items,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("th",x,Object(c["toDisplayString"])(t+1),1),Object(c["createElementVNode"])("td",null,[Object(c["createVNode"])(q,{to:"/cdn/surveys/"+e.id+"/votes"},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.item),1)]})),_:2},1032,["to"])]),Object(c["createElementVNode"])("td",B,Object(c["toDisplayString"])(e.survey_votes.length),1),Object(c["createElementVNode"])("td",null,Object(c["toDisplayString"])(e.created_at),1)])})),128))])])])])])])])])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(U,{modelValue:d.doesAddOpen,"onUpdate:modelValue":t[4]||(t[4]=function(e){return d.doesAddOpen=e}),id:"modal-center",centered:"",title:"Ajouter une option","title-class":"font-18","hide-footer":""},{default:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("form",{onSubmit:t[3]||(t[3]=Object(c["withModifiers"])((function(e){return P.addItem()}),["prevent"]))},[Object(c["createElementVNode"])("div",null,[C,Object(c["withDirectives"])(Object(c["createElementVNode"])("input",{type:"text",required:"","onUpdate:modelValue":t[2]||(t[2]=function(e){return D.item=e}),class:"form-control"},null,512),[[c["vModelText"],D.item]]),D.errors.item?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",S,Object(c["toDisplayString"])(D.errors.item),1)):Object(c["createCommentVNode"])("",!0)]),D.loading?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",A,L)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",w,_))],32)]})),_:1},8,["modelValue"])]})),_:1})}n("d3b7");var T=n("3d20"),q=n.n(T),U=n("444f"),F=n("c2a4"),M=n("2579"),z=n("e01f"),H={setup:function(){var e=Object(c["ref"])(!1),t=Object(c["ref"])(!1),n=Object(c["ref"])(!1);return{doesAddOpen:e,doesEditOpen:t,doesDeleteOpen:n}},page:{title:"Sondages",meta:[{name:"description",content:F.description}]},components:{Layout:U["a"],PageHeader:M["a"]},data:function(){return{title:"Sondages",items:[{text:"Menu",href:"/"},{text:"Sondages",active:!0},{text:"Un Sondage",active:!0}],id:"",item:"",errors:[],survey:{},survey_item:{},loading:!1,loadingPublish:!1,status:201}},methods:{getItem:function(){var e=this;fetch(z["a"].route("surveys/"+this.id),z["a"].requestOptions()).then((function(e){return z["a"].tokenChecker(e.status),e.json()})).then((function(t){console.log("surveys",t.data),e.survey=t.data}))},publishSurvey:function(){var e=this;this.loadingPublish=!0,fetch(z["a"].route("surveys/"+this.id+"/publish"),z["a"].requestOptions()).then((function(e){return z["a"].tokenChecker(e.status),e.json()})).then((function(t){e.loadingPublish=!1,e.survey=t.data,q.a.fire("Sondage publié !","Un message de rappel a été déjà envoyé  à tous les secteurs et partenaires pour participer de façon facultative.","success"),console.log(t)}))},addItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("item",this.item),t.append("survey_id",this.id),fetch(z["a"].route("survey-items"),z["a"].requestOptions("POST",t)).then((function(t){return z["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,200==e.status?(e.item="",e.doesAddOpen=!1,e.survey.survey_items.push(t.data),q.a.fire("Option ajouter !","Le sondage a été enregistré avec succès.","success")):e.errors.item=z["a"].getError(t.data,"item")})).catch((function(t){console.log(t),e.loading=!1}))},initItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit";this.survey_item=e,this.item=e.item,console.log("init",this.survey_item),"delete"==t?this.doesDeleteOpen=!0:this.doesEditOpen=!0}},mounted:function(){this.id=this.$route.params.id,this.getItem()},watch:{doesAddOpen:function(){this.errors=[]},doesDeleteOpen:function(){this.doesDeleteOpen||(this.participant=null)}}},J=n("6b0d"),$=n.n(J);const G=$()(H,[["render",I]]);t["default"]=G}}]);
//# sourceMappingURL=chunk-2d218068.070b61c6.js.map