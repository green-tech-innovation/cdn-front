(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2178f5"],{c6f2:function(e,t,n){"use strict";n.r(t);n("b0c0"),n("a4d3"),n("e01a");var r=n("7a23"),c={key:0,class:"hstack mb-3"},o={class:"ms-auto"},a={key:0},i=Object(r["createElementVNode"])("i",{class:"bx bx-send font-size-16 align-middle me-2"},null,-1),l=Object(r["createTextVNode"])(" Publier le formulaire "),s={key:1,class:"text-center"},d=Object(r["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(r["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),u=[d],m=Object(r["createElementVNode"])("i",{class:"bx bx-plus font-size-16 align-middle me-2"},null,-1),b=Object(r["createTextVNode"])(" Ajouter une nouvelle question "),p=Object(r["createElementVNode"])("i",{class:"bx bx-plus font-size-16 align-middle me-2"},null,-1),O=Object(r["createTextVNode"])(" Ajouter des participants "),j={key:1,class:"row"},f={class:"col-lg-12"},h={class:"card"},k={class:"card-body"},E={class:"card-title"},V={class:"text-danger mb-2"},g={class:"card-title-desc"},N={class:"bg-light p-3 pt-3"},v=Object(r["createElementVNode"])("h6",{class:"font-20 text-danger"},"♣ Listes des questions",-1),y={class:"table-responsive"},B={class:"table align-middle mb-0"},x=Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[Object(r["createElementVNode"])("th",null,"#"),Object(r["createElementVNode"])("th",null,"Question"),Object(r["createElementVNode"])("th",{class:"text-center"},"Réponse"),Object(r["createElementVNode"])("th",null,"Date d'ajout")])],-1),_={scope:"row"},C={class:"text-center"},q={class:"bg-light p-3 mt-4 pt-3"},z=Object(r["createElementVNode"])("h6",{class:"font-20 text-danger"},"♣ Listes des participants",-1),D={class:"table-responsive"},w={class:"table table-bordered table-striped align-middle mb-0"},S=Object(r["createElementVNode"])("th",null,"#",-1),A=Object(r["createElementVNode"])("th",null,"Nom du participant",-1),P={key:0},L={scope:"row"},F={key:0,class:"hstack"},T=Object(r["createElementVNode"])("i",{class:"bx bx-trash font-size-16 align-middle mx-1"},null,-1),I=Object(r["createElementVNode"])("label",{for:""},"Question",-1),U={key:0,class:"text-danger mt-2"},M={key:0,class:"mt-3"},J=Object(r["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),Q=[J],H={key:1,class:"mt-3 text-center"},R=Object(r["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(r["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),$=[R],G=Object(r["createElementVNode"])("label",{for:""},"Selectionnez l'entité",-1),K=["value"],W={key:0,class:"text-danger mt-2"},X={key:0,class:"mt-3"},Y=Object(r["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),Z=[Y],ee={key:1,class:"mt-3 text-center"},te=Object(r["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(r["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),ne=[te],re=Object(r["createElementVNode"])("p",{class:"mb-2"}," Voulez-vous vraiment supprimer le participant ? ",-1),ce={key:0,class:"hstack mt-2"},oe={key:1,class:"text-center"},ae=Object(r["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(r["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),ie=[ae];function le(e,t,n,d,J,R){var Y=Object(r["resolveComponent"])("PageHeader"),te=Object(r["resolveComponent"])("b-button"),ae=Object(r["resolveComponent"])("router-link"),le=Object(r["resolveComponent"])("b-modal"),se=Object(r["resolveComponent"])("Layout");return Object(r["openBlock"])(),Object(r["createBlock"])(se,null,{default:Object(r["withCtx"])((function(){return[Object(r["createVNode"])(Y,{title:J.title,items:J.items},null,8,["title","items"]),0==J.formular.is_published?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",c,[Object(r["createElementVNode"])("div",o,[0!=J.formular.formular_quizzes.length?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",a,[J.loadingPublish?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",s,u)):(Object(r["openBlock"])(),Object(r["createBlock"])(te,{key:0,variant:"success",onClick:t[0]||(t[0]=function(e){return R.publishFormular()}),class:"ms-auto"},{default:Object(r["withCtx"])((function(){return[i,l]})),_:1}))])):Object(r["createCommentVNode"])("",!0)]),Object(r["createVNode"])(te,{variant:"primary",class:"ms-3",onClick:t[1]||(t[1]=function(e){return d.doesAddOpen=!0})},{default:Object(r["withCtx"])((function(){return[m,b]})),_:1}),Object(r["createVNode"])(te,{variant:"primary",class:"ms-3",onClick:t[2]||(t[2]=function(e){return d.doesAddOpen1=!0})},{default:Object(r["withCtx"])((function(){return[p,O]})),_:1})])):Object(r["createCommentVNode"])("",!0),J.formular!={}?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",j,[Object(r["createElementVNode"])("div",f,[Object(r["createElementVNode"])("div",h,[Object(r["createElementVNode"])("div",k,[Object(r["createElementVNode"])("h4",E,Object(r["toDisplayString"])(J.formular.name),1),Object(r["createElementVNode"])("p",V," Date de Fin : "+Object(r["toDisplayString"])(J.formular.date),1),Object(r["createElementVNode"])("p",g,Object(r["toDisplayString"])(J.formular.description),1),Object(r["createElementVNode"])("div",N,[v,Object(r["createElementVNode"])("div",y,[Object(r["createElementVNode"])("table",B,[x,Object(r["createElementVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(J.formular.formular_quizzes,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:e.id},[Object(r["createElementVNode"])("th",_,Object(r["toDisplayString"])(t+1),1),Object(r["createElementVNode"])("td",null,[Object(r["createVNode"])(ae,{to:"/cdn/formulars/"+e.id+"/responses"},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.quiz),1)]})),_:2},1032,["to"])]),Object(r["createElementVNode"])("td",C,Object(r["toDisplayString"])(e.formular_responses.length),1),Object(r["createElementVNode"])("td",null,Object(r["toDisplayString"])(e.created_at),1)])})),128))])])])]),Object(r["createElementVNode"])("div",q,[z,Object(r["createElementVNode"])("div",D,[Object(r["createElementVNode"])("table",w,[Object(r["createElementVNode"])("thead",null,[Object(r["createElementVNode"])("tr",null,[S,A,J.formular.is_published?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("th",P,"Action"))])]),Object(r["createElementVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(J.formular.formular_participants,(function(e,t){return Object(r["openBlock"])(),Object(r["createElementBlock"])("tr",{key:e.id},[Object(r["createElementVNode"])("th",L,Object(r["toDisplayString"])(t+1),1),Object(r["createElementVNode"])("td",null,["PATNER"==e.entity.type?(Object(r["openBlock"])(),Object(r["createBlock"])(ae,{key:0,to:"/cdn/patners/"+e.entity.id},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.entity.name),1)]})),_:2},1032,["to"])):(Object(r["openBlock"])(),Object(r["createBlock"])(ae,{key:1,to:"/cdn/sectors/"+e.entity.id},{default:Object(r["withCtx"])((function(){return[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.entity.name),1)]})),_:2},1032,["to"]))]),J.formular.is_published?Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("td",F,[Object(r["createVNode"])(te,{variant:"danger",onClick:function(t){return R.initParticiant(e,"delete")},class:"ms-2 btn-sm"},{default:Object(r["withCtx"])((function(){return[T]})),_:2},1032,["onClick"])]))])})),128))])])])])])])])])):Object(r["createCommentVNode"])("",!0),Object(r["createVNode"])(le,{modelValue:d.doesAddOpen,"onUpdate:modelValue":t[5]||(t[5]=function(e){return d.doesAddOpen=e}),id:"modal-center",centered:"",title:"Ajouter une question","title-class":"font-18","hide-footer":""},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("form",{onSubmit:t[4]||(t[4]=Object(r["withModifiers"])((function(e){return R.addItem()}),["prevent"]))},[Object(r["createElementVNode"])("div",null,[I,Object(r["withDirectives"])(Object(r["createElementVNode"])("input",{type:"text",required:"","onUpdate:modelValue":t[3]||(t[3]=function(e){return J.quiz=e}),class:"form-control"},null,512),[[r["vModelText"],J.quiz]]),J.errors.quiz?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",U,Object(r["toDisplayString"])(J.errors.quiz),1)):Object(r["createCommentVNode"])("",!0)]),J.loading?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",H,$)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",M,Q))],32)]})),_:1},8,["modelValue"]),Object(r["createVNode"])(le,{modelValue:d.doesAddOpen1,"onUpdate:modelValue":t[8]||(t[8]=function(e){return d.doesAddOpen1=e}),id:"modal-center",centered:"",title:"Ajouter une participant","title-class":"font-18","hide-footer":""},{default:Object(r["withCtx"])((function(){return[Object(r["createElementVNode"])("form",{onSubmit:t[7]||(t[7]=Object(r["withModifiers"])((function(e){return R.addParticipant()}),["prevent"]))},[Object(r["createElementVNode"])("div",null,[G,Object(r["withDirectives"])(Object(r["createElementVNode"])("select",{required:"",multiple:"","onUpdate:modelValue":t[6]||(t[6]=function(e){return J.entity_id=e}),class:"form-control"},[(Object(r["openBlock"])(!0),Object(r["createElementBlock"])(r["Fragment"],null,Object(r["renderList"])(J.entities,(function(e){return Object(r["openBlock"])(),Object(r["createElementBlock"])("option",{key:e.id,value:e.id},Object(r["toDisplayString"])(e.name),9,K)})),128))],512),[[r["vModelSelect"],J.entity_id]]),J.errors.entity_id?(Object(r["openBlock"])(),Object(r["createElementBlock"])("span",W,Object(r["toDisplayString"])(J.errors.entity_id),1)):Object(r["createCommentVNode"])("",!0)]),J.loading?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ee,ne)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",X,Z))],32)]})),_:1},8,["modelValue"]),Object(r["createVNode"])(le,{modelValue:d.doesDeleteOpen,"onUpdate:modelValue":t[11]||(t[11]=function(e){return d.doesDeleteOpen=e}),id:"modal-center",title:"Supprimer la participant","title-class":"font-18","hide-footer":""},{default:Object(r["withCtx"])((function(){return[re,J.loading?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",oe,ie)):(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",ce,[Object(r["createElementVNode"])("button",{class:"btn btn-dark ms-auto",onClick:t[9]||(t[9]=function(e){return d.doesDeleteOpen=!1})},"Annuler"),Object(r["createElementVNode"])("button",{class:"ms-3 btn btn-danger",onClick:t[10]||(t[10]=function(e){return R.deleteIt()})},"Supprimer")]))]})),_:1},8,["modelValue"])]})),_:1})}n("d3b7"),n("e9c4"),n("4de4"),n("d81d");var se=n("3d20"),de=n.n(se),ue=n("444f"),me=n("c2a4"),be=n("2579"),pe=n("e01f"),Oe={setup:function(){var e=Object(r["ref"])(!1),t=Object(r["ref"])(!1),n=Object(r["ref"])(!1),c=Object(r["ref"])(!1);return{doesAddOpen:e,doesAddOpen1:t,doesEditOpen:n,doesDeleteOpen:c}},page:{title:"Evènement",meta:[{name:"description",content:me.description}]},components:{Layout:ue["a"],PageHeader:be["a"]},data:function(){return{title:"Formulaire",items:[{text:"Menu",href:"/"},{text:"Formulaire",active:!0},{text:"Un formulaire",active:!0}],id:"",quiz:"",entities:[],entity_id:null,participant:null,errors:[],formular:{},formular_quiz:{},loading:!1,loadingPublish:!1,status:201}},methods:{getItem:function(){var e=this;fetch(pe["a"].route("formulars/"+this.id),pe["a"].requestOptions()).then((function(e){return pe["a"].tokenChecker(e.status),e.json()})).then((function(t){console.log("formulars",t.data),e.formular=t.data}))},loadEntities:function(){var e=this;fetch(pe["a"].route("entities"),pe["a"].requestOptions()).then((function(e){return pe["a"].tokenChecker(e.status),e.json()})).then((function(t){e.entities=t.data}))},publishFormular:function(){var e=this;this.loadingPublish=!0,fetch(pe["a"].route("formulars/"+this.id+"/publish"),pe["a"].requestOptions()).then((function(e){return pe["a"].tokenChecker(e.status),e.json()})).then((function(t){e.loadingPublish=!1,e.formular=t.data,de.a.fire("Formulaire publié !","Un message de rappel a été déjà envoyé  à tous les secteurs et partenaires pour participer de façon facultative.","success"),console.log(t)}))},addItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("quiz",this.quiz),t.append("formular_id",this.id),fetch(pe["a"].route("formular-quizzes"),pe["a"].requestOptions("POST",t)).then((function(t){return pe["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,200==e.status?(e.quiz="",e.doesAddOpen=!1,e.formular.formular_quizzes.push(t.data),de.a.fire("Question ajouter !","La question a été enregistrée avec succès.","success")):e.errors.quiz=pe["a"].getError(t.data,"quiz")})).catch((function(t){console.log(t),e.loading=!1}))},addParticipant:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("formular_id",this.id),t.append("entity_id",JSON.stringify(this.entity_id)),fetch(pe["a"].route("formular-participants"),pe["a"].requestOptions("POST",t)).then((function(t){return pe["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(t),e.loading=!1,200==e.status?(e.entity_id=null,e.doesAddOpen1=!1,e.formular.formular_participants=t.data,de.a.fire("Participant ajouter !","Le(les) participants a (ont) été enregistré(s) avec succès.","success")):e.errors.entity_id=pe["a"].getError(t.data,"entity_id")})).catch((function(t){console.log(t),e.loading=!1}))},deleteIt:function(){var e=this;this.loading=!0,fetch(pe["a"].route("formular-participants/"+this.participant.id),pe["a"].requestOptions("DELETE")).then((function(t){return pe["a"].tokenChecker(t.status),e.status=t.status,t.text()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,e.doesDeleteOpen=!1,204==e.status?(e.formular.formular_participants=e.formular.formular_participants.filter((function(t){return t.id!==e.participant.id})),de.a.fire("Participant supprimer !","Le participant a été supprimé avec succès.","success")):de.a.fire("Participant non supprimer ?","La suppression n'a pas marché, veuillez réessayez plus tard.","error")}))},initItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit";this.formular_quiz=e,this.quiz=e.quiz,console.log("init",this.formular_quiz),"delete"==t?this.doesDeleteOpen=!0:this.doesEditOpen=!0},initParticiant:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit";this.participant=e,"delete"==t?this.doesDeleteOpen=!0:this.doesEditOpen=!0}},mounted:function(){this.id=this.$route.params.id,this.getItem(),this.loadEntities()},watch:{doesAddOpen:function(){this.errors=[]},doesAddOpen1:function(){var e=this;this.errors=[];for(var t=this.formular.formular_participants.map((function(e){return e.entity.id})),n=function(n){e.entities=e.entities.filter((function(e){return e.id!==t[n]}))},r=0;r<t.length;r++)n(r)},doesDeleteOpen:function(){this.doesDeleteOpen||(this.formular_quiz=null)}}},je=n("6b0d"),fe=n.n(je);const he=fe()(Oe,[["render",le]]);t["default"]=he}}]);
//# sourceMappingURL=chunk-2d2178f5.e20622cd.js.map