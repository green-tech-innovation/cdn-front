(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2264e0"],{e7a9:function(e,t,r){"use strict";r.r(t);r("b0c0");var o=r("7a23"),c={class:"hstack mb-3"},n=Object(o["createElementVNode"])("i",{class:"bx bx-plus font-size-16 align-middle me-2"},null,-1),l=Object(o["createTextVNode"])(" Ajouter un nouveau "),a={class:"row"},s={class:"col-lg-12"},i={class:"card"},d={class:"card-body"},u=Object(o["createElementVNode"])("h4",{class:"card-title"},"Listes des courriers",-1),m=Object(o["createElementVNode"])("p",{class:"card-title-desc"},[Object(o["createTextVNode"])(" Le tableau ci-dessous présente la listes des "),Object(o["createElementVNode"])("code",null,"courriers"),Object(o["createTextVNode"])(". ")],-1),b={class:"table-responsive"},O={class:"table align-middle mb-0"},j=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"#"),Object(o["createElementVNode"])("th",null,"Objet "),Object(o["createElementVNode"])("th",null,"Message "),Object(o["createElementVNode"])("th",null,"Date ")])],-1),p={scope:"row"},f={class:"text-truncate",style:{"max-width":"350px"}},h={class:"row"},E={class:"mb-3"},V=Object(o["createElementVNode"])("label",{for:""},"Selectionnez l'entité",-1),g=["value"],v={key:0,class:"text-danger mt-2"},N={class:"col-md-6 mb-3"},k=Object(o["createElementVNode"])("label",{for:""},"Objet du courrier",-1),y={key:0,class:"text-danger mt-2"},x={class:"col-md-6 mb-3"},B=Object(o["createElementVNode"])("label",{for:""},"Fichier du courrier (Facultatif)",-1),D=Object(o["createElementVNode"])("input",{type:"file",id:"file",class:"form-control"},null,-1),C={key:0,class:"text-danger mt-2"},w=Object(o["createElementVNode"])("label",{for:""},"Message du courrier",-1),S={key:0,class:"mt-3"},_=Object(o["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),L=[_],T={key:1,class:"mt-3 text-center"},M=Object(o["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(o["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),I=[M],q={class:"row"},A={class:"col-md-6 mb-3"},U=Object(o["createElementVNode"])("label",{for:""},"Nom du courrier",-1),F={key:0,class:"text-danger mt-2"},z={class:"col-md-6 mb-3"},P=Object(o["createElementVNode"])("label",{for:""},"Fichier du courrier (Facultatif)",-1),H=Object(o["createElementVNode"])("input",{type:"file",id:"file1",class:"form-control"},null,-1),J={key:0,class:"text-danger mt-2"},G=Object(o["createElementVNode"])("label",{for:""},"Message du courrier",-1),K={key:0,class:"mt-3"},Q=Object(o["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),R=[Q],W={key:1,class:"mt-3 text-center"},X=Object(o["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(o["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),Y=[X],Z={class:"mb-2"},$=Object(o["createTextVNode"])(" Voulez-vous vraiment supprimer le courrier "),ee={key:0,class:"hstack mt-2"},te={key:1,class:"text-center"},re=Object(o["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(o["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),oe=[re];function ce(e,t,r,_,M,Q){var X=Object(o["resolveComponent"])("PageHeader"),re=Object(o["resolveComponent"])("b-button"),ce=Object(o["resolveComponent"])("router-link"),ne=Object(o["resolveComponent"])("b-modal"),le=Object(o["resolveComponent"])("Layout");return Object(o["openBlock"])(),Object(o["createBlock"])(le,null,{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(X,{title:M.title,items:M.items},null,8,["title","items"]),Object(o["createElementVNode"])("div",c,[Object(o["createVNode"])(re,{variant:"primary",onClick:t[0]||(t[0]=function(e){return _.doesAddOpen=!0}),class:"ms-auto"},{default:Object(o["withCtx"])((function(){return[n,l]})),_:1})]),Object(o["createElementVNode"])("div",a,[Object(o["createElementVNode"])("div",s,[Object(o["createElementVNode"])("div",i,[Object(o["createElementVNode"])("div",d,[u,m,Object(o["createElementVNode"])("div",b,[Object(o["createElementVNode"])("table",O,[j,Object(o["createElementVNode"])("tbody",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(M.courriers,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:e.id},[Object(o["createElementVNode"])("th",p,Object(o["toDisplayString"])(t+1),1),Object(o["createElementVNode"])("td",null,[Object(o["createVNode"])(ce,{to:"/cdn/courriers/"+e.id},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.object),1)]})),_:2},1032,["to"])]),Object(o["createElementVNode"])("td",f,Object(o["toDisplayString"])(e.message),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.created_at),1)])})),128))])])])])])])]),Object(o["createVNode"])(ne,{modelValue:_.doesAddOpen,"onUpdate:modelValue":t[5]||(t[5]=function(e){return _.doesAddOpen=e}),id:"modal-center",centered:"",size:"lg",title:"Ajouter un courrier","title-class":"font-18","hide-footer":""},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("form",{onSubmit:t[4]||(t[4]=Object(o["withModifiers"])((function(e){return Q.addItem()}),["prevent"]))},[Object(o["createElementVNode"])("div",h,[Object(o["createElementVNode"])("div",E,[V,Object(o["withDirectives"])(Object(o["createElementVNode"])("select",{required:"","onUpdate:modelValue":t[1]||(t[1]=function(e){return M.to_id=e}),class:"form-control"},[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(M.entities,(function(e){return Object(o["openBlock"])(),Object(o["createElementBlock"])("option",{key:e.id,value:e.id},Object(o["toDisplayString"])(e.name),9,g)})),128))],512),[[o["vModelSelect"],M.to_id]]),M.errors.to_id?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",v,Object(o["toDisplayString"])(M.errors.to_id),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",N,[k,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",required:"","onUpdate:modelValue":t[2]||(t[2]=function(e){return M.object=e}),class:"form-control"},null,512),[[o["vModelText"],M.object]]),M.errors.object?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",y,Object(o["toDisplayString"])(M.errors.object),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",x,[B,D,M.errors.file?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",C,Object(o["toDisplayString"])(M.errors.file),1)):Object(o["createCommentVNode"])("",!0)])]),Object(o["createElementVNode"])("div",null,[w,Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return M.message=e}),required:"",class:"form-control",rows:"4"},null,512),[[o["vModelText"],M.message]])]),M.loading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",T,I)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",S,L))],32)]})),_:1},8,["modelValue"]),Object(o["createVNode"])(ne,{modelValue:_.doesEditOpen,"onUpdate:modelValue":t[9]||(t[9]=function(e){return _.doesEditOpen=e}),id:"modal-center",centered:"",size:"lg",title:"Modifier le courrier","title-class":"font-18","hide-footer":""},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("form",{onSubmit:t[8]||(t[8]=Object(o["withModifiers"])((function(e){return Q.editItem()}),["prevent"]))},[Object(o["createElementVNode"])("div",q,[Object(o["createElementVNode"])("div",A,[U,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",required:"","onUpdate:modelValue":t[6]||(t[6]=function(e){return M.object=e}),class:"form-control"},null,512),[[o["vModelText"],M.object]]),M.errors.object?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",F,Object(o["toDisplayString"])(M.errors.object),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",z,[P,H,M.errors.file?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",J,Object(o["toDisplayString"])(M.errors.file),1)):Object(o["createCommentVNode"])("",!0)])]),Object(o["createElementVNode"])("div",null,[G,Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{"onUpdate:modelValue":t[7]||(t[7]=function(e){return M.message=e}),required:"",class:"form-control",rows:"4"},null,512),[[o["vModelText"],M.message]])]),M.loading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",W,Y)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",K,R))],32)]})),_:1},8,["modelValue"]),Object(o["createVNode"])(ne,{modelValue:_.doesDeleteOpen,"onUpdate:modelValue":t[12]||(t[12]=function(e){return _.doesDeleteOpen=e}),id:"modal-center",title:"Supprimer le courrier","title-class":"font-18","hide-footer":""},{default:Object(o["withCtx"])((function(){var e;return[Object(o["createElementVNode"])("p",Z,[$,Object(o["createElementVNode"])("b",null,Object(o["toDisplayString"])(null===(e=M.courrier)||void 0===e?void 0:e.name),1)]),M.loading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",te,oe)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ee,[Object(o["createElementVNode"])("button",{class:"btn btn-dark ms-auto",onClick:t[10]||(t[10]=function(e){return _.doesDeleteOpen=!1})},"Annuler"),Object(o["createElementVNode"])("button",{class:"ms-3 btn btn-danger",onClick:t[11]||(t[11]=function(e){return Q.deleteIt()})},"Supprimer")]))]})),_:1},8,["modelValue"])]})),_:1})}r("a4d3"),r("e01a"),r("d3b7"),r("d81d"),r("4de4");var ne=r("3d20"),le=r.n(ne),ae=r("444f"),se=r("c2a4"),ie=r("2579"),de=r("e01f"),ue={setup:function(){var e=Object(o["ref"])(!1),t=Object(o["ref"])(!1),r=Object(o["ref"])(!1);return{doesAddOpen:e,doesEditOpen:t,doesDeleteOpen:r}},page:{title:"Courriers",meta:[{name:"description",content:se.description}]},components:{Layout:ae["a"],PageHeader:ie["a"]},data:function(){return{title:"Courriers",items:[{text:"Menu",href:"/"},{text:"Courriers",active:!0}],errors:[],courrier:{},courriers:[],entities:[],object:"",message:"",to_id:"",loading:!1,status:201}},methods:{loadList:function(){var e=this;fetch(de["a"].route("courriers"),de["a"].requestOptions()).then((function(e){return de["a"].tokenChecker(e.status),e.json()})).then((function(t){console.log(t.data),e.courriers=t.data}))},loadEntities:function(){var e=this;fetch(de["a"].route("entities"),de["a"].requestOptions()).then((function(e){return de["a"].tokenChecker(e.status),e.json()})).then((function(t){e.entities=t.data}))},addItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("object",this.object),t.append("message",this.message),t.append("to_id",this.to_id),void 0!=document.getElementById("file").files[0]&&t.append("file",document.getElementById("file").files[0]),fetch(de["a"].route("courriers"),de["a"].requestOptions("POST",t)).then((function(t){return de["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,200==e.status?(e.initData(null),e.doesAddOpen=!1,e.courriers.push(t.data),le.a.fire("Courrier ajouter !","Le courrier a été enregistré avec succès.","success")):(e.errors.object=de["a"].getError(t.data,"object"),e.errors.message=de["a"].getError(t.data,"message"),e.errors.file=de["a"].getError(t.data,"file"))})).catch((function(t){console.log(t),e.loading=!1}))},editItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("object",this.object),t.append("message",this.message),void 0!=document.getElementById("file1").files[0]&&t.append("file",document.getElementById("file1").files[0]),t.append("_method","PUT"),console.log(t.get("name"),"id",this.courrier.id),fetch(de["a"].route("courriers/"+this.courrier.id),de["a"].requestOptions("POST",t)).then((function(t){return de["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(e.status),console.log("last",e.courrier),console.log("new",t),e.loading=!1,200==e.status?(e.doesEditOpen=!1,e.courriers=e.courriers.map((function(r){return r.id!==e.courrier.id?r:t.data})),le.a.fire("Courrier modifier !","Le courrier a été modifié avec succès.","success")):(e.errors.object=de["a"].getError(t.data,"object"),e.errors.message=de["a"].getError(t.data,"message"),e.errors.file=de["a"].getError(t.data,"file"))})).catch((function(t){console.log(t),e.loading=!1}))},deleteIt:function(){var e=this;this.loading=!0,fetch(de["a"].route("courriers/"+this.courrier.id),de["a"].requestOptions("DELETE")).then((function(t){return de["a"].tokenChecker(t.status),e.status=t.status,t.text()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,e.doesDeleteOpen=!1,204==e.status?(e.courriers=e.courriers.filter((function(t){return t.id!==e.courrier.id})),le.a.fire("Courrier supprimer !","Le courrier a été supprimé avec succès.","success")):le.a.fire("Courrier non supprimer ?","La suppression n'a pas marché, veuillez réssayez plus tard.","error")}))},initItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit";this.courrier=e,this.initData(e),"delete"==t?this.doesDeleteOpen=!0:this.doesEditOpen=!0},initData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.object=null!=e?e.object:"",this.message=null!=e?e.message:"",this.to_id=null!=e?e.to_id:""}},mounted:function(){this.loadList(),this.loadEntities()},watch:{doesAddOpen:function(){this.errors=[]},doesEditOpen:function(){this.errors=[],this.doesEditOpen||(this.courrier=null,this.initData(null))},doesDeleteOpen:function(){this.doesDeleteOpen||(this.courrier=null,this.initData(null))}}},me=r("6b0d"),be=r.n(me);const Oe=be()(ue,[["render",ce]]);t["default"]=Oe}}]);
//# sourceMappingURL=chunk-2d2264e0.582f5665.js.map