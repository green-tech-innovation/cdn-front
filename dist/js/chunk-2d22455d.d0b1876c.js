(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d22455d"],{e062:function(e,t,n){"use strict";n.r(t);n("b0c0"),n("a4d3"),n("e01a");var c=n("7a23"),r={class:"hstack mb-3"},o=Object(c["createElementVNode"])("i",{class:"bx bx-plus font-size-16 align-middle me-2"},null,-1),a=Object(c["createTextVNode"])(" Ajouter un partnaire "),l={key:0,class:"row"},i={class:"col-lg-12"},s={class:"card"},d={class:"card-body"},b={class:"card-title text-primary mb-3"},u=Object(c["createElementVNode"])("b",null,"Secteur",-1),j=Object(c["createElementVNode"])("b",null,"Fichier du projet",-1),p=Object(c["createTextVNode"])(" : "),m=["href"],O=Object(c["createElementVNode"])("i",{class:"bx bx-download font-size-14 align-middle mx-1 text-white"},null,-1),E=Object(c["createTextVNode"])(" Télécharger le Fichier "),V=[O,E],h=Object(c["createElementVNode"])("b",null,"Progression",-1),f=Object(c["createElementVNode"])("b",null,"Date debut",-1),N=Object(c["createElementVNode"])("b",null,"Date Fin",-1),g=Object(c["createElementVNode"])("h6",null,[Object(c["createElementVNode"])("b",null,"Description")],-1),k={class:"card-title-desc"},v={class:"bg-light p-3 pt-3"},y=Object(c["createElementVNode"])("h6",{class:"font-20 text-danger"},"♣ Listes des partenaires",-1),x={class:"table-responsive"},_={class:"table align-middle mb-0"},B=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"#"),Object(c["createElementVNode"])("th",null,"Partenaire"),Object(c["createElementVNode"])("th",null,"Fichier du partenariat"),Object(c["createElementVNode"])("th",null,"Action")])],-1),D={scope:"row"},S=["href"],C=Object(c["createElementVNode"])("i",{class:"bx bx-download font-size-16 align-middle mx-1 text-white"},null,-1),w=Object(c["createTextVNode"])(" Télécharger le Fichier "),T=[C,w],L={class:"hstack"},A=Object(c["createElementVNode"])("i",{class:"bx bx-trash font-size-16 align-middle mx-1"},null,-1),P={class:"bg-light p-3 pt-3 mt-3"},F=Object(c["createElementVNode"])("h6",{class:"font-20 text-danger"},"♣ Listes des activités",-1),I={class:"table-responsive"},z={class:"table align-middle mb-0"},R=Object(c["createElementVNode"])("thead",null,[Object(c["createElementVNode"])("tr",null,[Object(c["createElementVNode"])("th",null,"#"),Object(c["createElementVNode"])("th",null,"Activité"),Object(c["createElementVNode"])("th",{class:"text-center"},"Progession"),Object(c["createElementVNode"])("th",{class:"text-center"},"Poids"),Object(c["createElementVNode"])("th",{class:"text-center"},"Montant alloué")])],-1),U={scope:"row"},q={class:"text-center"},G={class:"text-center"},M={class:"text-center text-black"},H={class:"mb-3"},J=Object(c["createElementVNode"])("label",{for:""},"Selectionnez l'entité",-1),$=Object(c["createElementVNode"])("option",{value:""},"Selectionnez l'entité",-1),K=["value"],Q={key:0,class:"text-danger mt-2"},W=Object(c["createElementVNode"])("label",{for:""},"Fichier du partenariat (Facultatif)",-1),X=Object(c["createElementVNode"])("input",{type:"file",id:"file",accept:".pdf, .docx",class:"form-control"},null,-1),Y={key:0,class:"text-danger mt-2"},Z={key:0,class:"mt-3"},ee=Object(c["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),te=[ee],ne={key:1,class:"mt-3 text-center"},ce=Object(c["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(c["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),re=[ce],oe={class:"mb-2"},ae=Object(c["createTextVNode"])(" Voulez-vous vraiment supprimer la catégorie "),le=Object(c["createTextVNode"])(" ? "),ie={key:0,class:"hstack mt-2"},se={key:1,class:"text-center"},de=Object(c["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(c["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),be=[de];function ue(e,t,n,O,E,C){var w=Object(c["resolveComponent"])("PageHeader"),ee=Object(c["resolveComponent"])("b-button"),ce=Object(c["resolveComponent"])("b-progress"),de=Object(c["resolveComponent"])("router-link"),ue=Object(c["resolveComponent"])("b-modal"),je=Object(c["resolveComponent"])("Layout");return Object(c["openBlock"])(),Object(c["createBlock"])(je,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(w,{title:E.title,items:E.items},null,8,["title","items"]),Object(c["createElementVNode"])("div",r,[Object(c["createVNode"])(ee,{variant:"primary",onClick:t[0]||(t[0]=function(e){return O.doesAddOpen=!0}),class:"ms-auto"},{default:Object(c["withCtx"])((function(){return[o,a]})),_:1})]),E.project.id?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",l,[Object(c["createElementVNode"])("div",i,[Object(c["createElementVNode"])("div",s,[Object(c["createElementVNode"])("div",d,[Object(c["createElementVNode"])("h4",b,Object(c["toDisplayString"])(E.project.name),1),Object(c["createElementVNode"])("p",null,[u,Object(c["createTextVNode"])(" : "+Object(c["toDisplayString"])(E.project.entity.name),1)]),Object(c["createElementVNode"])("p",null,[j,p,""!==E.project.file?(Object(c["openBlock"])(),Object(c["createElementBlock"])("a",{key:0,href:E.STORAGE_URL+E.project.file,target:"_blank",class:"btn btn-sm btn-success rounded-pill"},V,8,m)):Object(c["createCommentVNode"])("",!0)]),Object(c["createElementVNode"])("p",null,[h,Object(c["createTextVNode"])(" : "+Object(c["toDisplayString"])(E.project.progress)+"% ",1),Object(c["createVNode"])(ce,{value:E.project.progress,max:100,class:"mt-2",variant:"success"},null,8,["value"])]),Object(c["createElementVNode"])("p",null,[f,Object(c["createTextVNode"])(" : "+Object(c["toDisplayString"])(E.project.date_start),1)]),Object(c["createElementVNode"])("p",null,[N,Object(c["createTextVNode"])(" : "+Object(c["toDisplayString"])(E.project.date_end),1)]),g,Object(c["createElementVNode"])("p",k,Object(c["toDisplayString"])(E.project.description),1),Object(c["createElementVNode"])("div",v,[y,Object(c["createElementVNode"])("div",x,[Object(c["createElementVNode"])("table",_,[B,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(E.project.project_patners,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("th",D,Object(c["toDisplayString"])(t+1),1),Object(c["createElementVNode"])("td",null,[Object(c["createVNode"])(de,{to:"/cdn/patners/"+e.entity.id},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.entity.name),1)]})),_:2},1032,["to"])]),Object(c["createElementVNode"])("td",null,[e.file?(Object(c["openBlock"])(),Object(c["createElementBlock"])("a",{key:0,href:E.STORAGE_URL+e.file,target:"_blank",class:"btn btn-primary px-3 rounded-pill"},T,8,S)):Object(c["createCommentVNode"])("",!0)]),Object(c["createElementVNode"])("td",L,[Object(c["createVNode"])(ee,{variant:"danger",onClick:function(t){return C.initItem(e,"delete")},class:"ms-2 btn-sm"},{default:Object(c["withCtx"])((function(){return[A]})),_:2},1032,["onClick"])])])})),128))])])])]),Object(c["createElementVNode"])("div",P,[F,Object(c["createElementVNode"])("div",I,[Object(c["createElementVNode"])("table",z,[R,Object(c["createElementVNode"])("tbody",null,[(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(E.project.activities,(function(e,t){return Object(c["openBlock"])(),Object(c["createElementBlock"])("tr",{key:e.id},[Object(c["createElementVNode"])("th",U,Object(c["toDisplayString"])(t+1),1),Object(c["createElementVNode"])("td",null,[Object(c["createVNode"])(de,{to:"/cdn/activities/"+e.id},{default:Object(c["withCtx"])((function(){return[Object(c["createTextVNode"])(Object(c["toDisplayString"])(e.name),1)]})),_:2},1032,["to"])]),Object(c["createElementVNode"])("td",q,Object(c["toDisplayString"])(e.progress)+" %",1),Object(c["createElementVNode"])("td",G,Object(c["toDisplayString"])(e.weight),1),Object(c["createElementVNode"])("td",M,Object(c["toDisplayString"])(e.amount)+" F",1)])})),128))])])])])])])])])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(ue,{modelValue:O.doesAddOpen,"onUpdate:modelValue":t[3]||(t[3]=function(e){return O.doesAddOpen=e}),id:"modal-center",centered:"",title:"Ajouter un partenaire","title-class":"font-18","hide-footer":""},{default:Object(c["withCtx"])((function(){return[Object(c["createElementVNode"])("form",{onSubmit:t[2]||(t[2]=Object(c["withModifiers"])((function(e){return C.addItem()}),["prevent"]))},[Object(c["createElementVNode"])("div",H,[J,Object(c["withDirectives"])(Object(c["createElementVNode"])("select",{required:"","onUpdate:modelValue":t[1]||(t[1]=function(e){return E.entity_id=e}),class:"form-control"},[$,(Object(c["openBlock"])(!0),Object(c["createElementBlock"])(c["Fragment"],null,Object(c["renderList"])(E.entities,(function(e){return Object(c["openBlock"])(),Object(c["createElementBlock"])("option",{key:e.id,value:e.id},Object(c["toDisplayString"])(e.name),9,K)})),128))],512),[[c["vModelSelect"],E.entity_id]]),E.errors.entity?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",Q,Object(c["toDisplayString"])(E.errors.entity),1)):Object(c["createCommentVNode"])("",!0)]),Object(c["createElementVNode"])("div",null,[W,X,E.errors.file?(Object(c["openBlock"])(),Object(c["createElementBlock"])("span",Y,Object(c["toDisplayString"])(E.errors.file),1)):Object(c["createCommentVNode"])("",!0)]),E.loading?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",ne,re)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",Z,te))],32)]})),_:1},8,["modelValue"]),Object(c["createVNode"])(ue,{modelValue:O.doesDeleteOpen,"onUpdate:modelValue":t[6]||(t[6]=function(e){return O.doesDeleteOpen=e}),id:"modal-center",title:"Supprimer la catégorie","title-class":"font-18","hide-footer":""},{default:Object(c["withCtx"])((function(){var e,n;return[Object(c["createElementVNode"])("p",oe,[ae,Object(c["createElementVNode"])("b",null,Object(c["toDisplayString"])(null===(e=E.project_patner)||void 0===e||null===(n=e.entity)||void 0===n?void 0:n.name),1),le]),E.loading?(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",se,be)):(Object(c["openBlock"])(),Object(c["createElementBlock"])("div",ie,[Object(c["createElementVNode"])("button",{class:"btn btn-dark ms-auto",onClick:t[4]||(t[4]=function(e){return O.doesDeleteOpen=!1})},"Annuler"),Object(c["createElementVNode"])("button",{class:"ms-3 btn btn-danger",onClick:t[5]||(t[5]=function(e){return C.deleteIt()})},"Supprimer")]))]})),_:1},8,["modelValue"])]})),_:1})}n("d3b7"),n("4de4");var je=n("3d20"),pe=n.n(je),me=n("444f"),Oe=n("c2a4"),Ee=n("2579"),Ve=n("e01f"),he={setup:function(){var e=Object(c["ref"])(!1),t=Object(c["ref"])(!1),n=Object(c["ref"])(!1);return{doesAddOpen:e,doesEditOpen:t,doesDeleteOpen:n}},page:{title:"Projets",meta:[{name:"description",content:Oe.description}]},components:{Layout:me["a"],PageHeader:Ee["a"]},data:function(){return{title:"Projet",items:[{text:"Menu",href:"/"},{text:"Projet",active:!0},{text:"Un projet",active:!0}],errors:[],id:"",project_patner:{},project:{},entities:[],entity_id:"",loading:!1,status:201,STORAGE_URL:Ve["a"].STORAGE_URL}},methods:{getItem:function(){var e=this;fetch(Ve["a"].route("projects/"+this.id),Ve["a"].requestOptions()).then((function(e){return Ve["a"].tokenChecker(e.status),e.json()})).then((function(t){console.log(t.data),e.project=t.data}))},loadEntities:function(){var e=this;fetch(Ve["a"].route("entities?type=patner"),Ve["a"].requestOptions()).then((function(e){return Ve["a"].tokenChecker(e.status),e.json()})).then((function(t){e.entities=t.data}))},addItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("project_id",this.id),t.append("entity_id",this.entity_id),document.getElementById("file").files[0]&&t.append("file",document.getElementById("file").files[0]),fetch(Ve["a"].route("project-patners"),Ve["a"].requestOptions("POST",t)).then((function(t){return Ve["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,200==e.status?(e.doesAddOpen=!1,e.project.project_patners.push(t.data),pe.a.fire("Partenaire ajouter !","Le partenaire a été enregistré avec succès.","success")):(e.errors.entity_id=Ve["a"].getError(t.data,"entity_id"),e.errors.file=Ve["a"].getError(t.data,"file"))})).catch((function(t){console.log(t),e.loading=!1}))},deleteIt:function(){var e=this;this.loading=!0,console.log(this.project_patner.id),fetch(Ve["a"].route("project-patners/"+this.project_patner.id),Ve["a"].requestOptions("DELETE")).then((function(t){return Ve["a"].tokenChecker(t.status),e.status=t.status,t.text()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,e.doesDeleteOpen=!1,204==e.status?(e.project.project_patners=e.project.project_patners.filter((function(t){return t.id!==e.project_patner.id})),pe.a.fire("Partenaire supprimer !","Le partenaire a été supprimé avec succès.","success")):pe.a.fire("Partenaire non supprimer ?","La suppression n'a pas marché, veuillez réessayez plus tard.","error"),e.project_patner=null}))},initItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit";this.project_patner=e,this.name=e.entity.name,"delete"==t?this.doesDeleteOpen=!0:this.doesEditOpen=!0}},mounted:function(){this.id=this.$route.params.id,this.getItem(),this.loadEntities()},watch:{doesAddOpen:function(){this.errors=[]},doesEditOpen:function(){this.errors=[],this.doesEditOpen||(this.project_patner=null)},doesDeleteOpen:function(){this.doesDeleteOpen||(this.project_patner=null)}}},fe=n("6b0d"),Ne=n.n(fe);const ge=Ne()(he,[["render",ue]]);t["default"]=ge}}]);
//# sourceMappingURL=chunk-2d22455d.d0b1876c.js.map