(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0abe1a"],{"16ba":function(e,t,n){"use strict";n.r(t);n("b0c0"),n("a4d3"),n("e01a");var o=n("7a23"),c={class:"hstack mb-3"},a=Object(o["createElementVNode"])("i",{class:"bx bx-plus font-size-16 align-middle me-2"},null,-1),r=Object(o["createTextVNode"])(" Ajouter un nouveau "),s={class:"row"},l={class:"col-lg-12"},d={class:"card"},i={class:"card-body"},u=Object(o["createElementVNode"])("h4",{class:"card-title"},"Listes des sondages",-1),m=Object(o["createElementVNode"])("p",{class:"card-title-desc"},[Object(o["createTextVNode"])(" Le tableau ci-dessous présente la listes des "),Object(o["createElementVNode"])("code",null,"sondages"),Object(o["createTextVNode"])(". ")],-1),b={class:"table-responsive"},O={class:"table align-middle mb-0"},p=Object(o["createElementVNode"])("thead",null,[Object(o["createElementVNode"])("tr",null,[Object(o["createElementVNode"])("th",null,"#"),Object(o["createElementVNode"])("th",null,"Nom "),Object(o["createElementVNode"])("th",null,"Description "),Object(o["createElementVNode"])("th",null,"Date "),Object(o["createElementVNode"])("th",{class:"text-center"},"Sondage "),Object(o["createElementVNode"])("th",{class:"text-center"},"Peux voter "),Object(o["createElementVNode"])("th",null,"Action")])],-1),j={scope:"row"},f={class:"text-truncate",style:{"max-width":"250px"}},v={class:"text-center"},h={class:"text-center"},V={class:"hstack"},E=Object(o["createElementVNode"])("i",{class:"bx bx-edit font-size-16 align-middle mx-1"},null,-1),g=Object(o["createElementVNode"])("i",{class:"bx bx-trash font-size-16 align-middle mx-1"},null,-1),N={class:"row"},y={class:"col-md-6 mb-3"},k=Object(o["createElementVNode"])("label",{for:""},"Nom du sondage",-1),x={key:0,class:"text-danger mt-2"},D={class:"col-md-6 mb-3"},w=Object(o["createElementVNode"])("label",{for:""},"Date du sondage",-1),C={key:0,class:"text-danger mt-2"},B=Object(o["createElementVNode"])("label",{for:""},"Description du sondage",-1),S={key:0,class:"mt-3"},L=Object(o["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),T=[L],_={key:1,class:"mt-3 text-center"},q=Object(o["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(o["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),A=[q],M={class:"row"},U={class:"col-md-6 mb-3"},I=Object(o["createElementVNode"])("label",{for:""},"Nom du sondage",-1),z={key:0,class:"text-danger mt-2"},P={class:"col-md-6 mb-3"},F=Object(o["createElementVNode"])("label",{for:""},"Date du sondage",-1),H={key:0,class:"text-danger mt-2"},J=Object(o["createElementVNode"])("label",{for:""},"Description du sondage",-1),G={key:0,class:"mt-3"},K=Object(o["createElementVNode"])("input",{type:"submit",value:"Enregistrer",class:"btn btn-primary"},null,-1),Q=[K],R={key:1,class:"mt-3 text-center"},W=Object(o["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(o["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),X=[W],Y={class:"mb-2"},Z=Object(o["createTextVNode"])(" Voulez-vous vraiment supprimer le sondage "),$={key:0,class:"hstack mt-2"},ee={key:1,class:"text-center"},te=Object(o["createElementVNode"])("div",{class:"spinner-border text-primary",role:"status"},[Object(o["createElementVNode"])("span",{class:"visually-hidden"},"Loading...")],-1),ne=[te];function oe(e,t,n,L,q,K){var W=Object(o["resolveComponent"])("PageHeader"),te=Object(o["resolveComponent"])("b-button"),oe=Object(o["resolveComponent"])("router-link"),ce=Object(o["resolveComponent"])("b-modal"),ae=Object(o["resolveComponent"])("Layout");return Object(o["openBlock"])(),Object(o["createBlock"])(ae,null,{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(W,{title:q.title,items:q.items},null,8,["title","items"]),Object(o["createElementVNode"])("div",c,[Object(o["createVNode"])(te,{variant:"primary",onClick:t[0]||(t[0]=function(e){return L.doesAddOpen=!0}),class:"ms-auto"},{default:Object(o["withCtx"])((function(){return[a,r]})),_:1})]),Object(o["createElementVNode"])("div",s,[Object(o["createElementVNode"])("div",l,[Object(o["createElementVNode"])("div",d,[Object(o["createElementVNode"])("div",i,[u,m,Object(o["createElementVNode"])("div",b,[Object(o["createElementVNode"])("table",O,[p,Object(o["createElementVNode"])("tbody",null,[(Object(o["openBlock"])(!0),Object(o["createElementBlock"])(o["Fragment"],null,Object(o["renderList"])(q.surveys,(function(e,t){return Object(o["openBlock"])(),Object(o["createElementBlock"])("tr",{key:e.id},[Object(o["createElementVNode"])("th",j,Object(o["toDisplayString"])(t+1),1),Object(o["createElementVNode"])("td",null,[Object(o["createVNode"])(oe,{to:"/cdn/surveys/"+e.id},{default:Object(o["withCtx"])((function(){return[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.name),1)]})),_:2},1032,["to"])]),Object(o["createElementVNode"])("td",f,Object(o["toDisplayString"])(e.description),1),Object(o["createElementVNode"])("td",null,Object(o["toDisplayString"])(e.date),1),Object(o["createElementVNode"])("td",v,Object(o["toDisplayString"])(e.survey_items.length),1),Object(o["createElementVNode"])("td",h,Object(o["toDisplayString"])(e.can_vote&&e.is_published?"Oui":"Non"),1),Object(o["createElementVNode"])("td",V,[Object(o["createVNode"])(te,{class:"btn-sm",onClick:function(t){return K.initItem(e)},variant:"success"},{default:Object(o["withCtx"])((function(){return[E]})),_:2},1032,["onClick"]),Object(o["createVNode"])(te,{variant:"danger",onClick:function(t){return K.initItem(e,"delete")},class:"ms-2 btn-sm"},{default:Object(o["withCtx"])((function(){return[g]})),_:2},1032,["onClick"])])])})),128))])])])])])])]),Object(o["createVNode"])(ce,{modelValue:L.doesAddOpen,"onUpdate:modelValue":t[5]||(t[5]=function(e){return L.doesAddOpen=e}),id:"modal-center",centered:"",size:"lg",title:"Ajouter un sondage","title-class":"font-18","hide-footer":""},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("form",{onSubmit:t[4]||(t[4]=Object(o["withModifiers"])((function(e){return K.addItem()}),["prevent"]))},[Object(o["createElementVNode"])("div",N,[Object(o["createElementVNode"])("div",y,[k,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",required:"","onUpdate:modelValue":t[1]||(t[1]=function(e){return q.name=e}),class:"form-control"},null,512),[[o["vModelText"],q.name]]),q.errors.name?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",x,Object(o["toDisplayString"])(q.errors.name),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",D,[w,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"datetime-local",required:"","onUpdate:modelValue":t[2]||(t[2]=function(e){return q.date=e}),class:"form-control"},null,512),[[o["vModelText"],q.date]]),q.errors.date?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",C,Object(o["toDisplayString"])(q.errors.date),1)):Object(o["createCommentVNode"])("",!0)])]),Object(o["createElementVNode"])("div",null,[B,Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return q.description=e}),required:"",class:"form-control",rows:"4"},null,512),[[o["vModelText"],q.description]])]),q.loading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",_,A)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",S,T))],32)]})),_:1},8,["modelValue"]),Object(o["createVNode"])(ce,{modelValue:L.doesEditOpen,"onUpdate:modelValue":t[10]||(t[10]=function(e){return L.doesEditOpen=e}),id:"modal-center",centered:"",size:"lg",title:"Modifier le sondage","title-class":"font-18","hide-footer":""},{default:Object(o["withCtx"])((function(){return[Object(o["createElementVNode"])("form",{onSubmit:t[9]||(t[9]=Object(o["withModifiers"])((function(e){return K.editItem()}),["prevent"]))},[Object(o["createElementVNode"])("div",M,[Object(o["createElementVNode"])("div",U,[I,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"text",required:"","onUpdate:modelValue":t[6]||(t[6]=function(e){return q.name=e}),class:"form-control"},null,512),[[o["vModelText"],q.name]]),q.errors.name?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",z,Object(o["toDisplayString"])(q.errors.name),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createElementVNode"])("div",P,[F,Object(o["withDirectives"])(Object(o["createElementVNode"])("input",{type:"datetime-local",required:"","onUpdate:modelValue":t[7]||(t[7]=function(e){return q.date=e}),class:"form-control"},null,512),[[o["vModelText"],q.date]]),q.errors.date?(Object(o["openBlock"])(),Object(o["createElementBlock"])("span",H,Object(o["toDisplayString"])(q.errors.date),1)):Object(o["createCommentVNode"])("",!0)])]),Object(o["createElementVNode"])("div",null,[J,Object(o["withDirectives"])(Object(o["createElementVNode"])("textarea",{"onUpdate:modelValue":t[8]||(t[8]=function(e){return q.description=e}),required:"",class:"form-control",rows:"4"},null,512),[[o["vModelText"],q.description]])]),q.loading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",R,X)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",G,Q))],32)]})),_:1},8,["modelValue"]),Object(o["createVNode"])(ce,{modelValue:L.doesDeleteOpen,"onUpdate:modelValue":t[13]||(t[13]=function(e){return L.doesDeleteOpen=e}),id:"modal-center",title:"Supprimer le sondage","title-class":"font-18","hide-footer":""},{default:Object(o["withCtx"])((function(){var e;return[Object(o["createElementVNode"])("p",Y,[Z,Object(o["createElementVNode"])("b",null,Object(o["toDisplayString"])(null===(e=q.survey)||void 0===e?void 0:e.name),1)]),q.loading?(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",ee,ne)):(Object(o["openBlock"])(),Object(o["createElementBlock"])("div",$,[Object(o["createElementVNode"])("button",{class:"btn btn-dark ms-auto",onClick:t[11]||(t[11]=function(e){return L.doesDeleteOpen=!1})},"Annuler"),Object(o["createElementVNode"])("button",{class:"ms-3 btn btn-danger",onClick:t[12]||(t[12]=function(e){return K.deleteIt()})},"Supprimer")]))]})),_:1},8,["modelValue"])]})),_:1})}n("d3b7"),n("d81d"),n("4de4");var ce=n("3d20"),ae=n.n(ce),re=n("444f"),se=n("c2a4"),le=n("2579"),de=n("e01f"),ie={setup:function(){var e=Object(o["ref"])(!1),t=Object(o["ref"])(!1),n=Object(o["ref"])(!1);return{doesAddOpen:e,doesEditOpen:t,doesDeleteOpen:n}},page:{title:"Sondages",meta:[{name:"description",content:se.description}]},components:{Layout:re["a"],PageHeader:le["a"]},data:function(){return{title:"Sondages",items:[{text:"Menu",href:"/"},{text:"Sondages",active:!0}],errors:[],survey:{},surveys:[],name:"",description:"",date:"",loading:!1,status:201}},methods:{loadList:function(){var e=this;fetch(de["a"].route("surveys"),de["a"].requestOptions()).then((function(e){return de["a"].tokenChecker(e.status),e.json()})).then((function(t){console.log(t.data),e.surveys=t.data}))},addItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("name",this.name),t.append("description",this.description),t.append("date",this.date),fetch(de["a"].route("surveys"),de["a"].requestOptions("POST",t)).then((function(t){return de["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){e.loading=!1,200==e.status?(e.initData(null),e.doesAddOpen=!1,e.surveys.push(t.data),ae.a.fire("Sondage ajouter !","Le sondage a été enregistré avec succès.","success")):(e.errors.name=de["a"].getError(t.data,"name"),e.errors.description=de["a"].getError(t.data,"description"),e.errors.date=de["a"].getError(t.data,"date"))})).catch((function(t){console.log(t),e.loading=!1}))},editItem:function(){var e=this;this.loading=!0,this.errors=[];var t=new FormData;t.append("name",this.name),t.append("description",this.description),t.append("date",this.date),t.append("_method","PUT"),console.log(t.get("name"),"id",this.survey.id),fetch(de["a"].route("surveys/"+this.survey.id),de["a"].requestOptions("POST",t)).then((function(t){return de["a"].tokenChecker(t.status),e.status=t.status,t.json()})).then((function(t){console.log(e.status),console.log("last",e.survey),console.log("new",t),e.loading=!1,200==e.status?(e.doesEditOpen=!1,e.surveys=e.surveys.map((function(n){return n.id!==e.survey.id?n:t.data})),ae.a.fire("Sondage modifier !","Le sondage a été modifié avec succès.","success")):(e.errors.name=de["a"].getError(t.data,"name"),e.errors.description=de["a"].getError(t.data,"description"),e.errors.date=de["a"].getError(t.data,"date"))})).catch((function(t){console.log(t),e.loading=!1}))},deleteIt:function(){var e=this;this.loading=!0,fetch(de["a"].route("surveys/"+this.survey.id),de["a"].requestOptions("DELETE")).then((function(t){return de["a"].tokenChecker(t.status),e.status=t.status,t.text()})).then((function(t){console.log(e.status),console.log(t),e.loading=!1,e.doesDeleteOpen=!1,204==e.status?(e.surveys=e.surveys.filter((function(t){return t.id!==e.survey.id})),ae.a.fire("Sondage supprimer !","Le sondage a été supprimé avec succès.","success")):ae.a.fire("Sondage non supprimer ?","La suppression n'a pas marché, veuillez réssayez plus tard.","error")}))},initItem:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"edit";this.survey=e,this.initData(e),"delete"==t?this.doesDeleteOpen=!0:this.doesEditOpen=!0},initData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.name=null!=e?e.name:"",this.description=null!=e?e.description:"",this.date=null!=e?e.date:""}},mounted:function(){this.loadList()},watch:{doesAddOpen:function(){this.errors=[]},doesEditOpen:function(){this.errors=[],this.doesEditOpen||(this.survey=null,this.initData(null))},doesDeleteOpen:function(){this.doesDeleteOpen||(this.survey=null,this.initData(null))}}},ue=n("6b0d"),me=n.n(ue);const be=me()(ie,[["render",oe]]);t["default"]=be}}]);
//# sourceMappingURL=chunk-2d0abe1a.1d369735.js.map