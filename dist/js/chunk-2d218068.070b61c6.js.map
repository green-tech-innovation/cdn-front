{"version":3,"sources":["webpack:///./src/router/views/pages/cdn/surveys/show.vue","webpack:///./src/router/views/pages/cdn/surveys/show.vue?5c67"],"names":["class","role","scope","for","type","value","title","items","survey","is_published","survey_items","length","loadingPublish","variant","publishSurvey","doesAddOpen","name","date","description","survey_item","i","key","id","to","item","survey_votes","created_at","centered","title-class","hide-footer","addItem","required","errors","loading","setup","doesEditOpen","doesDeleteOpen","page","meta","content","components","Layout","PageHeader","data","text","href","active","status","methods","getItem","fetch","route","this","requestOptions","then","response","tokenChecker","json","console","log","fire","formData","FormData","append","push","getError","catch","error","initItem","action","mounted","$route","params","watch","participant","__exports__","render"],"mappings":"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","file":"js/chunk-2d218068.070b61c6.js","sourcesContent":["<script>\r\nimport Swal from 'sweetalert2'\r\n\r\nimport Layout from \"../../../../layouts/main\";\r\nimport appConfig from \"@/app.config\";\r\nimport PageHeader from \"@/components/page-header\";\r\nimport Helper from '@/helpers/helper';\r\n\r\nimport { ref } from \"vue\";\r\n\r\n\r\n/**\r\n * Dashboard Component\r\n */\r\nexport default {\r\n    setup() {\r\n        const doesAddOpen = ref(false);\r\n        const doesEditOpen = ref(false);\r\n        const doesDeleteOpen = ref(false);\r\n\r\n        return {\r\n            doesAddOpen,\r\n            doesEditOpen,\r\n            doesDeleteOpen,\r\n        };\r\n    },\r\n    page: {\r\n    title: \"Sondages\",\r\n    meta: [\r\n      {\r\n        name: \"description\",\r\n        content: appConfig.description,\r\n      },\r\n    ],\r\n  },\r\n  components: {\r\n    Layout,\r\n    PageHeader,\r\n  },\r\n  data() {\r\n    return {\r\n      title: \"Sondages\",\r\n      items: [\r\n        {\r\n          text: \"Menu\",\r\n          href: \"/\",\r\n        },\r\n        {\r\n          text: \"Sondages\",\r\n          active: true,\r\n        },\r\n        {\r\n          text: \"Un Sondage\",\r\n          active: true,\r\n        },\r\n      ],\r\n      id: \"\",\r\n      item: \"\",\r\n      errors: [],\r\n      survey: {},\r\n      survey_item: {},\r\n      loading: false,\r\n      loadingPublish: false,\r\n      status: 201,\r\n    };\r\n  },\r\n  methods: {\r\n    getItem() {\r\n      fetch(Helper.route('surveys/'+this.id), Helper.requestOptions())\r\n      .then(response => {\r\n          Helper.tokenChecker(response.status)\r\n          return response.json()\r\n      })\r\n      .then(data => {\r\n        console.log('surveys', data.data);\r\n        this.survey = data.data\r\n      })\r\n    },\r\n    publishSurvey() {\r\n        this.loadingPublish = true\r\n        fetch(Helper.route('surveys/'+this.id+'/publish'), Helper.requestOptions())\r\n        .then(response => {\r\n            Helper.tokenChecker(response.status)\r\n            return response.json()\r\n        })\r\n        .then(data => {\r\n            this.loadingPublish = false\r\n            this.survey = data.data\r\n            Swal.fire(\"Sondage publié !\", \"Un message de rappel a été déjà envoyé  à tous les secteurs et partenaires pour participer de façon facultative.\", \"success\");\r\n            console.log(data);\r\n        })\r\n    },\r\n    addItem() {\r\n      this.loading = true\r\n      this.errors = []\r\n      let formData = new FormData()\r\n      formData.append('item', this.item)\r\n      formData.append(\"survey_id\", this.id)\r\n      fetch(Helper.route('survey-items'), Helper.requestOptions(\"POST\", formData))\r\n      .then(response => {\r\n          Helper.tokenChecker(response.status)\r\n          this.status = response.status\r\n          return response.json()\r\n      })\r\n      .then(data => {\r\n        console.log(this.status);\r\n        console.log(data);\r\n        this.loading = false\r\n        if (this.status == 200) {\r\n          this.item = \"\"\r\n          this.doesAddOpen = false\r\n          this.survey.survey_items.push(data.data)\r\n          Swal.fire(\"Option ajouter !\", \"Le sondage a été enregistré avec succès.\", \"success\");\r\n        } else {\r\n          this.errors.item = Helper.getError(data.data, \"item\")\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.log(error);\r\n        this.loading = false\r\n      })\r\n    },\r\n    initItem(survey_item, action=\"edit\") {\r\n      this.survey_item = survey_item\r\n      this.item = survey_item.item\r\n      console.log('init', this.survey_item);\r\n      if (action == \"delete\") {\r\n        this.doesDeleteOpen = true\r\n      } else {\r\n        this.doesEditOpen = true\r\n      }\r\n    }\r\n  },\r\n  mounted() {\r\n    this.id = this.$route.params.id\r\n    this.getItem()\r\n  },\r\n  watch: {\r\n    doesAddOpen: function() {\r\n      this.errors = []\r\n    },\r\n    doesDeleteOpen: function() {\r\n      if (!this.doesDeleteOpen) {\r\n        this.participant = null\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <Layout>\r\n    <PageHeader :title=\"title\" :items=\"items\" />\r\n    \r\n    <div class=\"hstack mb-3\" v-if=\"survey.is_published == false\">\r\n        <div class=\"ms-auto\">\r\n            <div v-if=\"survey.survey_items.length != 0\">\r\n                <b-button variant=\"success\" v-if=\"!loadingPublish\" @click=\"publishSurvey()\" class=\"ms-auto\">\r\n                    <i class=\"bx bx-send font-size-16 align-middle me-2\"></i>\r\n                    Publier le sondage\r\n                </b-button>\r\n                <div class=\"text-center\" v-else>\r\n                    <div class=\"spinner-border text-primary\" role=\"status\">\r\n                        <span class=\"visually-hidden\">Loading...</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <b-button variant=\"primary\" class=\"ms-3\" @click=\"doesAddOpen = true\">\r\n            <i class=\"bx bx-plus font-size-16 align-middle me-2\"></i>\r\n            Ajouter un nouveau\r\n        </b-button>\r\n    </div>\r\n    \r\n    \r\n    <div class=\"row\" v-if=\"survey != {}\">\r\n      <div class=\"col-lg-12\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <h4 class=\"card-title\">{{ survey.name }}</h4>\r\n            <p class=\"text-danger mb-2\">\r\n                Date de Fin : {{ survey.date }}\r\n            </p>\r\n            <p class=\"card-title-desc\">\r\n              {{ survey.description }}\r\n            </p>\r\n            \r\n            <div class=\"bg-light p-3 pt-3\">\r\n                <h6 class=\"font-20 text-danger\">♣ Listes des options</h6>\r\n\r\n                <div class=\"table-responsive\">\r\n                    <table class=\"table align-middle mb-0\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>#</th>\r\n                                <th>Sondage</th>\r\n                                <th class=\"text-center\">Nombre de vote</th>\r\n                                <th>Date d'ajout</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            <tr v-for=\"(survey_item, i) in survey.survey_items\" :key=\"survey_item.id\">\r\n                                <th scope=\"row\">{{ i + 1 }}</th>\r\n                                <td>\r\n                                    <router-link :to=\"'/cdn/surveys/'+survey_item.id+'/votes'\">{{ survey_item.item }}</router-link>\r\n                                </td>\r\n                                <td class=\"text-center\">{{ survey_item.survey_votes.length }}</td>\r\n                                <td>{{ survey_item.created_at }}</td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n\r\n            </div>\r\n\r\n            \r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- ADD MODAL -->\r\n    <b-modal\r\n        v-model=\"doesAddOpen\"\r\n        id=\"modal-center\"\r\n        centered\r\n        title=\"Ajouter une option\"\r\n        title-class=\"font-18\"\r\n        hide-footer\r\n        >\r\n        <form @submit.prevent=\"addItem()\">\r\n          <div>\r\n            <label for=\"\">Option</label>\r\n            <input type=\"text\" required v-model=\"item\" class=\"form-control\">\r\n            <span class=\"text-danger mt-2\" v-if=\"errors.item\">{{ errors.item }}</span>\r\n          </div>\r\n          <div class=\"mt-3\" v-if=\"!loading\">\r\n            <input type=\"submit\" value=\"Enregistrer\" class=\"btn btn-primary\">\r\n          </div>\r\n          <div class=\"mt-3 text-center\" v-else>\r\n            <div class=\"spinner-border text-primary\" role=\"status\">\r\n              <span class=\"visually-hidden\">Loading...</span>\r\n            </div>\r\n          </div>\r\n        </form>\r\n    </b-modal>\r\n\r\n\r\n  </Layout>\r\n</template>\r\n","import { render } from \"./show.vue?vue&type=template&id=7fddc7b6\"\nimport script from \"./show.vue?vue&type=script&lang=js\"\nexport * from \"./show.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"G:\\\\Projets\\\\VueJs\\\\cdn\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}