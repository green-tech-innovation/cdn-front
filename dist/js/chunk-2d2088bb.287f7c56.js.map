{"version":3,"sources":["webpack:///./src/router/views/pages/cdn/annual-reports/index.vue","webpack:///./src/router/views/pages/cdn/annual-reports/index.vue?4f23"],"names":["class","scope","for","type","required","accept","id","value","role","title","items","annual_reports","annual_report","i","key","to","entity","name","href","STORAGE_URL","file","target","year","doesAddOpen","centered","title-class","hide-footer","addItem","errors","loading","setup","doesEditOpen","doesDeleteOpen","page","meta","content","description","components","Layout","PageHeader","data","text","active","status","methods","loadList","fetch","route","requestOptions","then","response","tokenChecker","json","console","log","this","formData","FormData","append","document","getElementById","files","Date","getFullYear","initData","push","fire","getError","message","catch","error","initItem","action","item","mounted","watch","__exports__","render"],"mappings":"oJA+JSA,MAAM,O,GACJA,MAAM,a,GACJA,MAAM,Q,GACJA,MAAM,a,EACT,gCAAsD,MAAlDA,MAAM,cAAa,8BAA0B,G,EACjD,gCAEI,KAFDA,MAAM,mBAAiB,C,6BAAC,kDACoB,gCAA4B,YAAtB,mB,6BAAsB,Q,kCACvE,oB,GAECA,MAAM,oB,GACFA,MAAM,2B,EACX,gCAQQ,cAPN,gCAMK,WALH,gCAAU,UAAN,KACJ,gCAAgB,UAAZ,WACJ,gCAAuB,UAAnB,kBACJ,gCAAgB,UAAZ,WACJ,gCAAc,UAAV,a,MAKAC,MAAM,O,aAOJ,gCAAwE,KAArED,MAAM,4DAA0D,S,+BAAK,iB,GAAxE,E,MAwBXA,MAAM,O,GACJA,MAAM,Q,EACP,gCAA2C,SAApCE,IAAI,IAAG,yBAAqB,G,SAE7BF,MAAM,oB,EAGZ,gCAA+C,SAAxCE,IAAI,IAAG,6BAAyB,G,EACvC,gCAAgF,SAAzEC,KAAK,OAAOC,SAAA,GAASC,OAAO,cAAcC,GAAG,OAAON,MAAM,gB,kBAC3DA,MAAM,oB,SAGbA,MAAM,Q,EACT,gCAAiE,SAA1DG,KAAK,SAASI,MAAM,cAAcP,MAAM,mB,YAA/C,G,SAEGA,MAAM,oB,EACT,gCAEM,OAFDA,MAAM,8BAA8BQ,KAAK,U,CAC5C,gCAA+C,QAAzCR,MAAM,mBAAkB,gB,MADhC,G,8OA/EV,yBAuFS,Q,8BAtFP,iBAA4C,CAA5C,yBAA4C,GAA/BS,MAAO,EAAAA,MAAQC,MAAO,EAAAA,O,0BASnC,gCAyCM,MAzCN,EAyCM,CAxCJ,gCAuCM,MAvCN,EAuCM,CAtCJ,gCAqCM,MArCN,EAqCM,CApCJ,gCAmCM,MAnCN,EAmCM,CAlCJ,EACA,E,EAIA,gCA4BM,MA5BN,EA4BM,CA3BJ,gCA0BQ,QA1BR,EA0BQ,CAzBN,EASA,gCAeQ,e,2BAdN,gCAaK,2CAb4B,EAAAC,gBAAc,SAAnCC,EAAeC,G,gCAA3B,gCAaK,MAb6CC,IAAKF,EAAcN,I,CACnE,gCAAgC,KAAhC,EAAgC,6BAAbO,EAAI,GAAH,GACpB,gCAEK,WADH,yBAAwG,GAA1FE,GAAE,gBAAkBH,EAAcI,OAAOV,I,+BAAI,iBAA+B,C,0DAA5BM,EAAcI,OAAOC,MAAI,O,oBAEzF,gCAAiC,uCAA1BL,EAAcK,MAAI,GACzB,gCAKK,WAJD,gCAGI,KAHAC,KAAM,EAAAC,YAAYP,EAAcQ,KAAMC,OAAO,SAASrB,MAAM,gC,SAKpE,gCAAiC,uCAA1BY,EAAcU,MAAI,Q,oBAWzC,yBA8BU,G,WA7BG,EAAAC,Y,qDAAA,EAAAA,YAAW,IACpBjB,GAAG,eACHkB,SAAA,GACAf,MAAM,4BACNgB,cAAY,UACZC,cAAA,I,+BAEA,iBAqBO,CArBP,gCAqBO,QArBA,SAAM,2DAAU,EAAAC,YAAO,e,CAC5B,gCAWM,MAXN,EAWM,CAVJ,gCAIM,MAJN,EAIM,CAHF,E,4BACA,gCAAgE,SAAzDxB,KAAK,OAAOC,SAAA,G,qDAAkB,EAAAa,KAAI,IAAEjB,MAAM,gB,4BAAZ,EAAAiB,QACA,EAAAW,OAAOX,M,yBAA5C,gCAA0E,OAA1E,EAA0E,6BAArB,EAAAW,OAAOX,MAAI,I,yCAEpE,gCAIM,YAHF,EACA,EACqC,EAAAW,OAAOR,M,yBAA5C,gCAA0E,OAA1E,EAA0E,6BAArB,EAAAQ,OAAOR,MAAI,I,2CAG7C,EAAAS,S,yBAGzB,gCAIM,MAJN,EAIM,K,yBAPN,gCAEM,MAFN,EAEM,K,gJApND,GACXC,MADW,WAEP,IAAMP,EAAc,kBAAI,GAClBQ,EAAe,kBAAI,GACnBC,EAAiB,kBAAI,GAE3B,MAAO,CACPT,cACAQ,eACAC,mBAGJC,KAAM,CACNxB,MAAO,2BACPyB,KAAM,CACJ,CACEjB,KAAM,cACNkB,QAAS,EAAUC,eAIzBC,WAAY,CACVC,OAAA,OACAC,WAAA,QAEFC,KAzBa,WA0BX,MAAO,CACL/B,MAAO,2BACPC,MAAO,CACL,CACE+B,KAAM,OACNvB,KAAM,KAER,CACEuB,KAAM,2BACNC,QAAQ,IAGZd,OAAQ,GACRhB,cAAe,KACfD,eAAgB,GAChBM,KAAM,GACNK,KAAM,GACNO,SAAS,EACTV,YAAa,OAAOA,YACpBwB,OAAQ,MAGZC,QAAS,CACPC,SADO,WACI,WACTC,MAAM,OAAOC,MAAM,kBAAmB,OAAOC,kBAC5CC,MAAK,SAAAC,GAEF,OADA,OAAOC,aAAaD,EAASP,QACtBO,EAASE,UAEnBH,MAAK,SAAAT,GACJa,QAAQC,IAAId,EAAKA,MACjB,EAAK7B,eAAiB6B,EAAKA,SAG/Bb,QAZO,WAYG,WACR4B,KAAK1B,SAAU,EACf0B,KAAK3B,OAAS,GACd,IAAI4B,EAAW,IAAIC,SACnBD,EAASE,OAAO,OAAQH,KAAKtC,MAC7BuC,EAASE,OAAO,OAAQC,SAASC,eAAe,QAAQC,MAAM,IAC9DL,EAASE,OAAO,QAAQ,IAAII,MAAOC,eACnCjB,MAAM,OAAOC,MAAM,kBAAmB,OAAOC,eAAe,OAAQQ,IACnEP,MAAK,SAAAC,GAGF,OAFA,OAAOC,aAAaD,EAASP,QAC7B,EAAKA,OAASO,EAASP,OAChBO,EAASE,UAEnBH,MAAK,SAAAT,GACJ,EAAKX,SAAU,EACI,KAAf,EAAKc,QACP,EAAKpB,aAAc,EACnB,EAAKyC,SAAS,MACd,EAAKrD,eAAesD,KAAKzB,EAAKA,MAC9B,IAAK0B,KAAK,2BAA4B,kDAAmD,YAEnF1B,EAAKA,MACP,EAAKZ,OAAOX,KAAO,OAAOkD,SAAS3B,EAAKA,KAAM,QAC9C,EAAKZ,OAAOR,KAAO,OAAO+C,SAAS3B,EAAKA,KAAM,UAE9C,EAAKjB,aAAc,EACnB,EAAKyC,SAAS,MACd,IAAKE,KAAK,+BAAgC1B,EAAK4B,QAAS,aAI/DC,OAAM,SAAAC,GACLjB,QAAQC,IAAIgB,GACZ,EAAKzC,SAAU,MAGnB0C,SAhDO,SAgDE3D,GAA8B,IAAf4D,EAAe,uDAAR,OAC3BjB,KAAK3C,cAAgBA,EACrB2C,KAAKS,SAASpD,GACA,UAAV4D,EACJjB,KAAKvB,gBAAiB,EAEtBuB,KAAKxB,cAAe,GAGxBiC,SAzDO,WAyDe,IAAbS,EAAa,uDAAN,KACdlB,KAAKtC,KAAe,MAARwD,EAAeA,EAAKxD,KAAO,GACvCsC,KAAKjC,KAAe,MAARmD,EAAeA,EAAKnD,KAAO,KAG3CoD,QA9Ga,WA+GXnB,KAAKV,YAEP8B,MAAO,CACLpD,YAAa,WACXgC,KAAK3B,OAAS,IAEhBG,aAAc,WACZwB,KAAK3B,OAAS,GACT2B,KAAKxB,eACRwB,KAAK3C,cAAgB,KACrB2C,KAAKS,SAAS,QAGlBhC,eAAgB,WACTuB,KAAKvB,iBACRuB,KAAK3C,cAAgB,KACrB2C,KAAKS,SAAS,U,qBCxItB,MAAMY,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASC,KAErD","file":"js/chunk-2d2088bb.287f7c56.js","sourcesContent":["<script>\r\nimport Swal from 'sweetalert2'\r\n\r\nimport Layout from \"../../../../layouts/main\";\r\nimport appConfig from \"@/app.config\";\r\nimport PageHeader from \"@/components/page-header\";\r\nimport Helper from '@/helpers/helper';\r\n\r\nimport { ref } from \"vue\";\r\n\r\n\r\n/**\r\n * Dashboard Component\r\n */\r\nexport default {\r\n    setup() {\r\n        const doesAddOpen = ref(false);\r\n        const doesEditOpen = ref(false);\r\n        const doesDeleteOpen = ref(false);\r\n\r\n        return {\r\n        doesAddOpen,\r\n        doesEditOpen,\r\n        doesDeleteOpen,\r\n        };\r\n    },\r\n    page: {\r\n    title: \"Tous les rapport annuels\",\r\n    meta: [\r\n      {\r\n        name: \"description\",\r\n        content: appConfig.description,\r\n      },\r\n    ],\r\n  },\r\n  components: {\r\n    Layout,\r\n    PageHeader,\r\n  },\r\n  data() {\r\n    return {\r\n      title: \"Tous les rapport annuels\",\r\n      items: [\r\n        {\r\n          text: \"Menu\",\r\n          href: \"/\",\r\n        },\r\n        {\r\n          text: \"Tous les rapport annuels\",\r\n          active: true,\r\n        },\r\n      ],\r\n      errors: [],\r\n      annual_report: null,\r\n      annual_reports: [],\r\n      name: \"\",\r\n      year: \"\",\r\n      loading: false,\r\n      STORAGE_URL: Helper.STORAGE_URL,\r\n      status: 201,\r\n    };\r\n  },\r\n  methods: {\r\n    loadList() {\r\n      fetch(Helper.route('annual-reports'), Helper.requestOptions())\r\n      .then(response => {\r\n          Helper.tokenChecker(response.status)\r\n          return response.json()\r\n      })\r\n      .then(data => {\r\n        console.log(data.data);\r\n        this.annual_reports = data.data\r\n      })\r\n    },\r\n    addItem() {\r\n      this.loading = true\r\n      this.errors = []\r\n      let formData = new FormData()\r\n      formData.append('name', this.name)\r\n      formData.append('file', document.getElementById(\"file\").files[0])\r\n      formData.append('year', new Date().getFullYear())\r\n      fetch(Helper.route('annual-reports'), Helper.requestOptions(\"POST\", formData))\r\n      .then(response => {\r\n          Helper.tokenChecker(response.status)\r\n          this.status = response.status\r\n          return response.json()\r\n      })\r\n      .then(data => {\r\n        this.loading = false\r\n        if (this.status == 200) {\r\n          this.doesAddOpen = false\r\n          this.initData(null)\r\n          this.annual_reports.push(data.data)\r\n          Swal.fire(\"Rapport annuel ajouter !\", \"Le rapport annuel a été enregistré avec succès.\", \"success\");\r\n        } else { \r\n            if (data.data) {\r\n              this.errors.name = Helper.getError(data.data, \"name\")\r\n              this.errors.file = Helper.getError(data.data, \"file\")\r\n            } else {\r\n              this.doesAddOpen = false\r\n              this.initData(null)\r\n              Swal.fire(\"Rapport annuel non ajouter ?\", data.message, \"error\");\r\n            }\r\n        }\r\n      })\r\n      .catch(error => {\r\n        console.log(error);\r\n        this.loading = false\r\n      })\r\n    },\r\n    initItem(annual_report, action=\"edit\") {\r\n        this.annual_report = annual_report\r\n        this.initData(annual_report)\r\n        if (action == \"delete\") {\r\n        this.doesDeleteOpen = true\r\n        } else {\r\n        this.doesEditOpen = true\r\n        }\r\n    },\r\n    initData(item = null) {\r\n      this.name = item != null ? item.name : \"\"\r\n      this.year = item != null ? item.year : \"\"\r\n    }\r\n  },\r\n  mounted() {\r\n    this.loadList()\r\n  },\r\n  watch: {\r\n    doesAddOpen: function() {\r\n      this.errors = []\r\n    },\r\n    doesEditOpen: function() {\r\n      this.errors = []\r\n      if (!this.doesEditOpen) {\r\n        this.annual_report = null\r\n        this.initData(null)\r\n      }\r\n    },\r\n    doesDeleteOpen: function() {\r\n      if (!this.doesDeleteOpen) {\r\n        this.annual_report = null\r\n        this.initData(null)\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <Layout>\r\n    <PageHeader :title=\"title\" :items=\"items\" />\r\n\r\n    <!-- <div class=\"hstack mb-3\">\r\n        <b-button variant=\"primary\" @click=\"doesAddOpen = true\" class=\"ms-auto\">\r\n            <i class=\"bx bx-plus font-size-16 align-middle me-2\"></i>\r\n            Ajouter un nouveau\r\n        </b-button>\r\n    </div> -->\r\n    \r\n    <div class=\"row\">\r\n      <div class=\"col-lg-12\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <h4 class=\"card-title\">Listes des rapport annuels</h4>\r\n            <p class=\"card-title-desc\">\r\n              Le tableau ci-dessous présente la listes des <code>rapport annuels</code>.\r\n            </p>\r\n            annual_reports\r\n            <div class=\"table-responsive\">\r\n              <table class=\"table align-middle mb-0\">\r\n                <thead>\r\n                  <tr>\r\n                    <th>#</th>\r\n                    <th>Secteur</th>\r\n                    <th>Nom du rapport</th>\r\n                    <th>Fichier</th>\r\n                    <th>Année</th>\r\n                  </tr>\r\n                </thead>\r\n                <tbody>\r\n                  <tr v-for=\"(annual_report, i) in annual_reports\" :key=\"annual_report.id\">\r\n                    <th scope=\"row\">{{ i + 1 }}</th>\r\n                    <td>\r\n                      <router-link :to=\"'/cdn/sectors/'+annual_report.entity.id\">{{ annual_report.entity.name }}</router-link>\r\n                    </td>\r\n                    <td>{{ annual_report.name }}</td>\r\n                    <td>\r\n                        <a :href=\"STORAGE_URL+annual_report.file\" target=\"_blank\" class=\"btn btn-primary rounded-pill\">\r\n                          <i class=\"bx bx-download font-size-16 align-middle mx-1 text-white\"></i>\r\n                          Télécharger\r\n                        </a>\r\n                    </td>\r\n                    <td>{{ annual_report.year }}</td>\r\n                  </tr>\r\n                </tbody>\r\n              </table>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- ADD MODAL -->\r\n    <b-modal\r\n        v-model=\"doesAddOpen\"\r\n        id=\"modal-center\"\r\n        centered\r\n        title=\"Ajouter un rapport annuel\"\r\n        title-class=\"font-18\"\r\n        hide-footer\r\n        >\r\n        <form @submit.prevent=\"addItem()\">\r\n          <div class=\"row\">\r\n            <div class=\"mb-3\">\r\n                <label for=\"\">Nom du rapport annuel</label>\r\n                <input type=\"text\" required v-model=\"name\" class=\"form-control\">\r\n                <span class=\"text-danger mt-2\" v-if=\"errors.name\">{{ errors.name }}</span>\r\n            </div>\r\n            <div>\r\n                <label for=\"\">Fichier du rapport annuel</label>\r\n                <input type=\"file\" required accept=\".pdf, .docx\" id=\"file\" class=\"form-control\">\r\n                <span class=\"text-danger mt-2\" v-if=\"errors.file\">{{ errors.file }}</span>\r\n            </div>\r\n          </div>\r\n          <div class=\"mt-3\" v-if=\"!loading\">\r\n            <input type=\"submit\" value=\"Enregistrer\" class=\"btn btn-primary\">\r\n          </div>\r\n          <div class=\"mt-3 text-center\" v-else>\r\n            <div class=\"spinner-border text-primary\" role=\"status\">\r\n              <span class=\"visually-hidden\">Loading...</span>\r\n            </div>\r\n          </div>\r\n        </form>\r\n    </b-modal>\r\n\r\n\r\n  </Layout>\r\n</template>\r\n","import { render } from \"./index.vue?vue&type=template&id=15f2b7f5\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"G:\\\\Projets\\\\VueJs\\\\cdn\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}